add_namespace = ww1_auh
# FRANZ I DIES
####################
news_event = {
	id = ww1_auh.1
	title = ww1_auh.1.t
	desc = ww1_auh.1.d
	picture = ww1_austria_1
	major = yes
	mean_time_to_happen = {
		days = 21
	}
	fire_only_once = yes
	trigger = {
		OR = {
			any_country = {
				OR = {
					has_country_leader = {
						character = AUH_franz_joseph_i
						ruling_only = no
					}
					has_country_leader = {
						character = HUN_franz_joseph_i
						ruling_only = no
					}
					has_country_leader = {
						character = AUS_franz_joseph_i
						ruling_only = no
					}
				}
			}
			AND = {
				AUH = {
					exists = no
					NOT = {
						has_country_flag = emperor_franz_dead
					}
				}
				AUS = {
					exists = no
					NOT = {
						has_country_flag = emperor_franz_dead
					}
				}
				GER = {
					has_completed_focus = GER_backstab
					any_owned_state = {				
						OR = {
							state = 4
							state = 39
							state = 102
							state = 147
							state = 152
							state = 153
							state = 244
							state = 736
						}
					}	
				}
			}
		}
		
		OR = {
			date > 1916.11.1
			AND = {
				has_global_flag = interbellum
				AUH = {
					exists = yes
					has_country_flag = great_war_loser
				}
			}
		}
	}
	immediate = {
		hidden_effect = {
			if = {
				limit = {
					has_global_flag = kis_franzferdinand_murdered 
				}

				else = {
					
				}
			}
			AUH = {
				if = {
					limit = {
						has_country_leader = {
							character = AUH_franz_joseph_i
							ruling_only = no
						}	
					}
					if = {
						limit = {
							has_global_flag = kis_franzferdinand_murdered 
						}
						AUH_karl_i = {
							set_character_name = "AUH_karl_i"
							promote_character = autocracy
							if = {
								limit = {
									is_field_marshal = no									
								}
								promote_leader = yes
							}
						}
						else = {
							AUH_franz_ferdinand_i = {
								set_character_name = "AUH_franz_ferdinand_i"
								promote_character = autocracy
	
							}
						}
					}			
				}
				set_country_flag = emperor_franz_dead
				retire_character = AUH_franz_joseph_i
			}
			HUN = {
				if = {
					limit = {
						has_country_leader = {
							character = HUN_franz_joseph_i
						}	
					}
					promote_character = HUN_karl_i
					promote_character = HUN_franz_ferdinand_i
				}
				set_country_flag = emperor_franz_dead
				retire_character = HUN_franz_joseph_i
			}
			AUS = {
				if = {
					limit = {
						has_country_leader = {
							character = AUS_franz_joseph_i
							ruling_only = yes
						}	
					}
					AUS_karl_i = {
						add_country_leader_role = {
							country_leader = {
								ideology = autocracy
							}
						}
						promote_character = autocracy
					}
					AUS_franz_ferdinand_i = {
						add_country_leader_role = {
							country_leader = {
								ideology = autocracy
							}
						}
						promote_character = autocracy
					}
				}
				set_country_flag = emperor_franz_dead
				retire_character = AUS_franz_joseph_i
			}
		}
	}
	option = {
		name = ww1_auh.1.a
		ai_chance = {
			factor = 100
		}
		trigger = {
			TAG = AUH
		}
	}
	option = {
		name = ww1_auh.1.b
		ai_chance = {
			factor = 100
		}
		trigger = {
			NOT = {
				TAG = AUH
			}
		}
	}
}

# DEAL WITH ITALY
#################
country_event = {
	id = ww1_auh.2
	title = ww1_auh.2.t
	desc = ww1_auh.2.d
	picture = GFX_report_event_generic_read_write
	is_triggered_only = yes
	option = {
		name = ww1_auh.2.a
		ITA = {
			country_event = {
				days = 1
				id = ww1_auh.3
			}
		}
		ai_chance = {
			factor = 100
		}
	}
}

# DEAL WITH ITALY
#################
country_event = {
	id = ww1_auh.3
	title = ww1_auh.3.t
	desc = ww1_auh.3.d
	picture = GFX_report_event_generic_read_write
	is_triggered_only = yes
	option = {
		name = ww1_auh.3.a
		transfer_state = 244
		transfer_state = 513
		AUH = {
			remove_state_core = 244
			remove_state_core = 513
		}
		GER = {
			add_to_faction = ITA
		}
		remove_ideas = idea_italy_triple_alliance
		news_event = {
			id = ww1_auh.4
		}
		add_opinion_modifier = {
			target = AUH
			modifier = large_increase
		}
		reverse_add_opinion_modifier = {
			target = AUH
			modifier = large_increase
		}
		ai_chance = {
			factor = 100
		}
	}
	option = {
		name = ww1_auh.3.b
		set_global_flag = ita_rejected_the_deal
		reverse_add_opinion_modifier = {
			target = AUH
			modifier = faction_traitor
		}
		reverse_add_opinion_modifier = {
			target = GER
			modifier = faction_traitor
		}
		add_ai_strategy = {
			type = alliance
			id = GER
			value = -200
		}
		add_ai_strategy = {
			type = alliance
			id = AUH
			value = -200
		}
		diplomatic_relation = {
			country = GER
			relation = guarantee
			active = no
		}
		diplomatic_relation = {
			country = AUH
			relation = guarantee
			active = no
		}
		AUH = {
			diplomatic_relation = {
				country = ITA
				relation = guarantee
				active = no
			}
			add_ai_strategy = {
				type = alliance
				id = ITA
				value = -200
			}
			unlock_national_focus = AUH_deportation_of_italians
		}
		GER = {
			diplomatic_relation = {
				country = ITA
				relation = guarantee
				active = no
			}
			add_ai_strategy = {
				type = alliance
				id = ITA
				value = -200
			}
		}
		remove_ideas = idea_italy_triple_alliance
		ai_chance = {
			factor = 0
		}
	}
}

# DEAL WITH ITALY - NEWS
###############################
news_event = {
	id = ww1_auh.4
	title = ww1_auh.4.t
	desc = ww1_auh.4.d
	picture = EVENT_hoi4tgw_trialism
	is_triggered_only = yes
	major = yes
	option = {
		name = ww1_auh.4.a
		ai_chance = {
			factor = 100
		}
	}
}

# SERBIAN PROTECTORATE
#################
country_event = {
	id = ww1_auh.5
	title = ww1_auh.5.t
	desc = ww1_auh.5.d
	picture = GFX_report_event_generic_read_write
	is_triggered_only = yes
	option = {
		name = ww1_auh.5.a
		every_other_country = {
			limit = {
				is_subject_of = PREV
			}
			hidden_effect = {
				set_country_flag = serbian_subject
			}
		}
		set_country_flag = protectorate
		if = {
			limit = {
				OR = {
					has_dlc = "Together for Victory"
					has_dlc = "Waking the Tiger"
				}
			}
			AUH = {
				set_autonomy = {
					target = SER
					autonomous_state = autonomy_tgwr_informal_protectorate
					freedom_level = 0.8
				}
			}
			else = {
				AUH = {
					puppet = SER
					SER = {
						add_ideas = protectorate
					}
				}
			}
		}
		hidden_effect = {
			every_other_country = {
				limit = {
					has_country_flag = serbian_subject
				}
				if = {
					limit = {
						has_dlc = "Together for Victory"
					}
					PREV = {
						set_autonomy = {
							target = PREV
							autonomous_state = autonomy_dominion
						}
					}
					else = {
						PREV = {
							puppet = PREV
						}
					}
				}
			}
		}
		news_event = {
			id = ww1_auh.6
		}
		ai_chance = {
			factor = 2
		}
	}
	option = {
		name = ww1_auh.5.b
		AUH = {
			give_guarantee = SER
		}
		ai_chance = {
			factor = 1
		}
	}
}

# SERBIAN PROTECTORATE -  NEWS
#################
news_event = {
	id = ww1_auh.6
	title = ww1_auh.6.t
	desc = ww1_auh.6.d
	picture = EVENT_hoi4tgw_trialism
	is_triggered_only = yes
	major = yes
	option = {
		name = ww1_auh.6.a
		ai_chance = {
			factor = 100
		}
	}
}

# AUSTRIA CONTAIN RUSSIA
#################
country_event = {
	id = ww1_auh.7
	title = ww1_auh.7.t
	desc = ww1_auh.7.d
	picture = GFX_report_event_generic_read_write
	is_triggered_only = yes
	option = {
		name = ww1_auh.7.a
		add_political_power = -100
		add_war_support = 0.05
		AUH = {
			country_event = {
				id = ww1_auh.8
				days = 2
			}
		}
		ai_chance = {
			factor = 100
		}
	}
	option = {
		name = ww1_auh.7.b
		#remove_ideas = { RUS_defender_of_balkans }
		ai_chance = {
			factor = 0
		}
	}
}

# AUSTRIA CONTAIN RUSSIA - ANSWER OF RUSSIA
#################
country_event = {
	id = ww1_auh.8
	title = ww1_auh.8.t
	desc = ww1_auh.8.d
	picture = GFX_report_event_generic_read_write
	is_triggered_only = yes
	option = {
		name = ww1_auh.8.a
		ai_chance = {
			factor = 100
		}
	}
}

# ESTABLISHMENT OF UNITARY MONARCHY
#################
news_event = {
	id = ww1_auh.9
	title = ww1_auh.9.t
	desc = ww1_auh.9.d
	picture = EVENT_hoi4tgw_trialism
	is_triggered_only = yes
	major = yes
	option = {
		name = ww1_auh.9.a
		ai_chance = {
			factor = 100
		}
	}
}

# DEAL WITH ROMANIA
#################
country_event = {
	id = ww1_auh.10
	title = ww1_auh.10.t
	desc = ww1_auh.10.d
	picture = GFX_report_event_generic_read_write
	is_triggered_only = yes
	option = {
		name = ww1_auh.10.a
		add_opinion_modifier = {
			target = AUH
			modifier = large_increase
		}
		AUH = {
			add_opinion_modifier = {
				target = ROM
				modifier = large_increase
			}
			country_event = {
				id = ww1_auh.11
				days = 2
			}
		}
		GER = {
			add_to_faction = ROM
		}
		ai_chance = {
			factor = 30
		}
	}
	option = {
		name = ww1_auh.10.b
		ai_chance = {
			factor = 10
		}
	}
}

# DEAL WITH ROMANIA - AUSTRIA GIVES SOUTH TRANSILVANIA
#################
country_event = {
	id = ww1_auh.11
	title = ww1_auh.11.t
	desc = ww1_auh.11.d
	picture = GFX_report_event_generic_read_write
	is_triggered_only = yes
	option = {
		name = ww1_auh.11.a
		AUH = {
			every_owned_state = {
				limit = {
					OR = {
						state = 76
						state = 84
						state = 778
					}
				}
				remove_core_of = AUH
				transfer_state_to = ROM
			}
		}
		every_state = {
			limit = {
				OWNER = {
					is_subject_of = AUH
				}
				OR = {
					state = 76
					state = 84
					state = 778
				}
			}
			remove_core_of = AUH
			transfer_state_to = ROM
		}
		news_event = {
			id = ww1_auh.12
		}
		ai_chance = {
			factor = 100
		}
	}
}

# DEAL WITH ROMANIA - NEWS
#################
news_event = {
	id = ww1_auh.12
	title = ww1_auh.12.t
	desc = ww1_auh.12.d
	picture = EVENT_hoi4tgw_trialism
	is_triggered_only = yes
	major = yes
	option = {
		name = ww1_auh.12.a
		ai_chance = {
			factor = 100
		}
	}
}

# AUSTRIA LOST GREAT WAR - CROATIA LEAVES
############################################
country_event = {
	id = ww1_auh.13
	title = ww1_auh.13.t
	desc = ww1_auh.13.d
	picture = GFX_report_event_ger_civil_war
	trigger = {
		tag = AUH
		has_country_flag = great_war_loser
		NOT = {
			has_global_flag = AUH_collapse
			#has_global_flag = croatia_released
			#SER = { has_country_flag = great_war_loser }
		}
	}
	fire_only_once = yes
	mean_time_to_happen = {
		days = 3
	}
	immediate = {
		hidden_effect = {
			set_global_flag = croatia_released
			every_state = {
				limit = {
					is_core_of = CRO
				}
				remove_core_of = CRO
			}
			if = {
				limit = {
					has_subject = CRO
				}
				end_puppet = CRO
			}
			CRO = {
				load_oob = CRO_1918
				AUH = {
					transfer_navy = {
						target = PREV
					}
				}
				clr_country_flag = great_war_loser
				remove_ideas = idea_army_restrictions
				set_popularities = {
					fascism = 3
					communism = 1
					democratic = 54
					neutrality = 42
				}
				set_politics = {
					ruling_party = democratic
					elections_allowed = yes
				}
				drop_cosmetic_tag = yes
			}
			BOS = {
				drop_cosmetic_tag = yes
				retire_character = BOS_marijan_varesanin
			}
			if = {
				limit = {
					SER = { has_country_flag = great_war_loser }
				}
				if = {
					limit = {
						owns_state = 104
					}
					104 = {
						add_core_of = BOS
						transfer_state_to = BOS
						remove_core_of = AUH
						if = {
							limit = {
								AUH = {
									OR = {
										has_completed_focus = AUH_unitary_monarchy
										has_completed_focus = AUH_reform_transleithania
									}
								}
							}
							add_claim_by = AUH	
						}
					}
				}
				every_state = {
					limit = {
						OR = {
							state = 109
							state = 103
							state = 208
							state = 575
							state = 163
						}
					}
					add_core_of = CRO
					if = {
						limit = {
							OR = {
								is_owned_by = AUH
								is_owned_by = AUS
							}
						}	
						transfer_state_to = CRO
					}
					if = {
						limit = {
							AUH = {
								OR = {
									has_completed_focus = AUH_unitary_monarchy
									has_completed_focus = AUH_reform_transleithania
								}
							}
						}
						add_claim_by = AUH
						remove_core_of = AUH
					}
				}
				513 = {
					if = {
						limit = {
							OR = {
								is_owned_by = AUH
								is_owned_by = AUS
							}
						}	
						transfer_state_to = CRO
					}
				}
				every_owned_state = {
					limit = {
						is_core_of = MNT
					}
					transfer_state_to = MNT
				}
				every_owned_state = {
					limit = {
						is_core_of = SER
					}
					transfer_state_to = SER
				}
				if = {
					limit = {
						ITA = {
							has_country_flag = great_war_winner
						}
					}
					every_state = {
						limit = {
							OR = {
								is_owned_by = CRO
								is_owned_by = AUH
								is_owned_by = AUS
							}
							OR = {
								is_claimed_by = ITA
								is_core_of = ITA
								state = 163
								state = 736
								state = 513
							}
						}
						transfer_state_to = ITA
					}
				}
				else = {
					every_state = {
						limit = {
							OR = {
								state = 109
								state = 103
								state = 104
								state = 102
								state = 208
								state = 575
								state = 163
								state = 736
							}
						}
						add_core_of = CRO
						if = {
							limit = {
								OR = {
									is_owned_by = AUH
									is_owned_by = AUS
								}
							}	
							transfer_state_to = CRO
						}
						remove_core_of = AUH
						if = {
							limit = {
								AUH = {
									OR = {
										has_completed_focus = AUH_unitary_monarchy
										has_completed_focus = AUH_reform_transleithania
									}
								}
							}
							add_claim_by = AUH
						}
					}
					513 = {
						if = {
							limit = {
								OR = {
									is_owned_by = AUH
									is_owned_by = AUS
								}
							}	
							transfer_state_to = CRO
						}
					}
					CRO = {
						set_cosmetic_tag = CRO_SSCS
						set_party_name = {
							ideology = democratic
							long_name = CRO_national_council_party_long
							name = CRO_national_council_party
						}
						set_party_name = {
							ideology = neutrality
							long_name = CRO_national_council_party_long
							name = CRO_national_council_party
						}
						if = {
							limit = {
								SLV = {
									exists = no
								}
							}
							SLV = {
								SLV_anton_korosec = { set_nationality = CRO }
							}
							SLV_anton_korosec = {
								promote_character = conservatism
								promote_character = authoritarian_democracy
							}
						}
					}
					if = {
						limit = {
							ITA = {
								has_country_flag = great_war_winner
							}
						}
						every_state = {
							limit = {
								OR = {
									is_owned_by = CRO
									is_owned_by = AUH
									is_owned_by = AUS
								}
								OR = {
									is_claimed_by = ITA
									is_core_of = ITA
								}	
								OR = {
									state = 163
									state = 736
								}
							}
							transfer_state_to = ITA
						}
					}
				}
			}
			if = {
				limit = {
					ITA = {
						owns_state = 736
					}
					CRO = {
						owns_state = 513
					}
				}
				513 = {
					set_demilitarized_zone = yes
				}
			}	
		}
	}
	option = {
		name = ww1_auh.13.a
		effect_tooltip = {
			release = CRO
		}
		ai_chance = {
			factor = 100
		}
	}
	option = {
		name = ww1_auh.13.b
		CRO = { change_tag_from = PREV }
		ai_chance = {
			factor = 0
		}
	}
}

# AUSTRIA LOST GREAT WAR - CZECHOSLOVAKIA LEAVES
###################################################
country_event = {
	id = ww1_auh.14
	title = ww1_auh.14.t
	desc = ww1_auh.14.d
	picture = GFX_report_event_ger_civil_war
	trigger = {
		tag = AUH
		has_country_flag = great_war_loser
		NOT = {
			has_global_flag = AUH_collapse
			has_global_flag = czechoslovakia_released
			# has_completed_focus = AUH_unitary_monarchy
			# has_completed_focus = AUH_reform_transleithania
		}
	}
	fire_only_once = yes
	mean_time_to_happen = {
		days = 2
	}
        immediate = {
                hidden_effect = {
                        set_global_flag = czechoslovakia_released
                        every_state = {
                                limit = {
                                       is_owned_by = AUH
                                        OR = {
                                                state = 9
                                                state = 72
                                                state = 75
                                        }
                                }
                                remove_core_of = AUH
                                transfer_state_to = CZE
                                AUH = {
                                        if = {
                                                limit = {
                                                        has_completed_focus = AUH_unitary_monarchy
                                                }
                                                add_state_claim = PREV
                                                else = {
                                                        remove_state_core = 9
                                                        remove_state_core = 75
                                                        remove_state_core = 72
                                                }
                                        }			
                                }			
                        }
                        CZE = {
                                if = {
                                        limit = {
                                                is_subject_of = AUH
                                        }
                                        AUH = {
                                                end_puppet = PREV
                                        }
                                }
                                drop_cosmetic_tag = yes
                                clr_country_flag = CZE_ONLY
                                load_oob = CZE_1918
                                set_politics = {
                                        ruling_party = democratic
                                        last_election = "1910.1.1"
                                        election_frequency = 48
                                        elections_allowed = yes
                                }
                                set_popularities = {
                                        fascism = 0
                                        communism = 2
                                        democratic = 78
                                        neutrality = 20
                                }
                                every_state = {
                                        limit = {
                                                OR = {
                                                        state = 70
                                                        state = 71
                                                        state = 72
                                                        state = 73
                                                        state = 664
                                                }
                                        }
                                        add_core_of = CZE
                                }
                                if = {
                                        limit = {
                                                AUH = {
                                                        OR = {
                                                                has_completed_focus = AUH_reform_transleithania
                                                                has_completed_focus = AUH_unitary_monarchy
                                                        }
                                                }
                                        }
                                        if = {
                                                limit = {
                                                        AUH = {
                                                                NOT = {
                                                                        owns_state = 69
                                                                        owns_state = 74
                                                                }
                                                        }
                                                }
                                                every_state = {
                                                        limit = {
                                                                is_owned_by = CZE
                                                                OR = {
                                                                        state = 69
                                                                        state = 74
                                                                }
                                                        }
                                                        transfer_state_to = AUH
                                                }
                                        }
                                        give_military_access = AUH
                                }
                        }
                }
        }
	option = {
		name = ww1_auh.14.a
		effect_tooltip = {
			release = CZE
		}
		ai_chance = {
			factor = 100
		}
	}
     option = {
		name = ww1_auh.14.b
        CZE = { change_tag_from = PREV }
		ai_chance = {
			factor = 0
		}
	}
}

# AUSTRIA LOST GREAT WAR - POLAND LEAVES 
###########################################
country_event = {
	id = ww1_auh.15
	#title = ww1_auh.15.t
	#desc = ww1_auh.15.d
	#picture = GFX_report_event_ger_civil_war
	trigger = {
		original_tag = AUH
		has_country_flag = great_war_loser
		NOT = {
			has_global_flag = AUH_collapse
			has_global_flag = galicia_released
			# has_completed_focus = AUH_unitary_monarchy
			# has_completed_focus = AUH_reform_transleithania
		}
	}
	fire_only_once = yes
	mean_time_to_happen = {
		days = 1
	}
	hidden = yes
	immediate = {
		set_global_flag = galicia_released
		every_state = {
			limit = {
				is_core_of = GAL
			}
			remove_core_of = AUH
			AUH = {
				if = {
					limit = {
						has_completed_focus = AUH_unitary_monarchy
					}
					add_state_claim = PREV
				}
			}
		}
		if = {
			limit = {
				RUS = {
					has_country_flag = great_war_winner
					OR = {
						owns_state = 90
						owns_state = 92
						owns_state = 766
						owns_state = 93
					}
				}
				POL = {
					exists = no
				}
			}
			every_state = {
				limit = {
					is_core_of = GAL
					OR = {
						is_owned_by = AUH
						is_owned_by = AUS
						is_owned_by = GAL
					}
				}
				RUS = {
					transfer_state = PREV
				}
			}
		}
		else_if = {
			limit = {
				RUS = {
					has_country_flag = great_war_winner
					OR = {
						owns_state = 766
						owns_state = 93
					}
				}
				POL = {
					exists = yes
				}
				UKR = {
					exists = no
				}
			}
			every_state = {
				limit = {
					OR = {
						is_owned_by = AUH
						is_owned_by = AUS
						is_owned_by = GAL
					}
					is_core_of = UKR
				}
				RUS = {
					transfer_state = PREV
				}
			}
			every_state = {
				limit = {
					OR = {
						is_owned_by = AUH
						is_owned_by = AUS
						is_owned_by = GAL
					}
					is_core_of = POL
					NOT = {
						state = 72
					}
				}
				POL = {
					transfer_state = PREV
				}
			}
			else = {
				every_state = {
					limit = {
						OR = {
							is_owned_by = AUH
							is_owned_by = AUS
							is_owned_by = GAL
						}
						is_core_of = UKR
						NOT = {
							state = 73
							state = 237
						}
					}
					WUK = {
						transfer_state = PREV
						every_owned_state = {
							add_core_of = WUK
						}
					}
				}
				every_state = {
					limit = {
						OR = {
							is_owned_by = AUH
							is_owned_by = AUS
							is_owned_by = GAL
						}
						is_core_of = POL
						NOT = {
							state = 72
						}
					}
					POL = {
						transfer_state = PREV
					}
				}
			}
		}
		if = {
			limit = {
				80 = {
					OR = {
						is_owned_by = AUH
						is_owned_by = AUS
					}
				}	
			}
			every_country = {
				limit = {
					owns_state = 79
				}
				transfer_state = 80
				transfer_state = 867
			}
		}	
		every_state = {
			limit = {
				is_core_of = GAL
			}
			remove_core_of = GAL
		}
	}
}

# AUSTRIA LOST GREAT WAR - HUNGARY LEAVES
############################################
country_event = {
	id = ww1_auh.16
	title = ww1_auh.16.t
	desc = ww1_auh.16.d
	picture = GFX_report_event_ger_civil_war
	trigger = {
		tag = AUH
		has_country_flag = great_war_loser
		NOT = {
			has_global_flag = AUH_collapse
			has_global_flag = hungary_released
			# has_completed_focus = AUH_unitary_monarchy
			# has_completed_focus = AUH_reform_transleithania
		}
		HUN = {
			OR = {
				exists = no
				is_subject_of = ROOT
			}
		}	
	}
	fire_only_once = yes
	mean_time_to_happen = {
		days = 5
	}
	immediate = {
		hidden_effect = {
			set_global_flag = hungary_released
			set_cosmetic_tag = AUH_EMP
			HUN = {
				if = {
					limit = {
						is_subject_of = AUH
					}
					AUH = {
						end_puppet = PREV
					}
				}
				if = {
					limit = {
						OR = {
							exists = no
							is_subject_of = AUH
						}
					}	
					load_oob = HUN_1918
					set_politics = {
						ruling_party = democratic
						elections_allowed = yes
					}
					set_popularities = {
						democratic = 40
						neutrality = 36
						communism = 24
					}
					set_country_flag = great_war_loser
					drop_cosmetic_tag = yes
					retire_character = HUN_franz_joseph_i
					retire_character = HUN_franz_ferdinand_i
					remove_country_leader_role = { #for potential restoration
						character = HUN_karl_i
						ideology = autocracy
					}
					remove_ideas = AUH_ww1_House_Habsburg_Lorraine
					set_party_name = {
						ideology = neutrality
						long_name = HUN_neutrality_party
						name = HUN_neutrality_party
					}
					promote_character = HUN_joseph_august
				}
			}
			every_state = {
				limit = {
					OR = {
						is_owned_by = AUS
						is_owned_by = AUH
					}
					OR = {
						is_core_of = HUN
						is_core_of = TRA
						is_core_of = SLO
						state = 73
					}
				}
				transfer_state_to = HUN
				remove_core_of = AUH
				AUH = {
					if = {
						limit = {
							has_completed_focus = AUH_unitary_monarchy
						}
						add_state_claim = PREV
					}
					add_state_core = 147
				}
			}
			if = {
				limit = {
					OR = {
						has_completed_focus = AUH_unitary_monarchy
						has_completed_focus = AUH_reform_transleithania
					}
				}
				every_state = {
					limit = {
						is_owned_by = HUN
						is_core_of = AUH
					}
					remove_core_of = AUH
				}
			}
			AUH_franz_rohr_von_denta = {
				if = {
					limit = {
						is_field_marshal = no									
					}
					promote_leader = yes
				}
				set_nationality = HUN
			}	
			AUH_miklós_horthy = {
				set_nationality = HUN
			}	
		}
	}
	option = {
		name = ww1_auh.16.a
		effect_tooltip = {
			release = HUN
		}
		ai_chance = {
			factor = 100
		}
	}
	option = {
		name = ww1_auh.16.b
		HUN = { change_tag_from = PREV }
		ai_chance = {
			factor = 0
		}
	}
}

# AUSTRIA LOST GREAT WAR - DEATH OF EMPIRE
#############################################
country_event = {
	id = ww1_auh.17
	title = ww1_auh.17.t
	desc = ww1_auh.17.d
	picture = GFX_report_event_ger_civil_war
	trigger = {
		tag = AUH
		has_country_flag = great_war_loser
		has_global_flag = hungary_released
		has_global_flag = croatia_released
		has_global_flag = czechoslovakia_released
		has_global_flag = galicia_released
		NOT = {
			has_global_flag = AUH_collapse
			has_completed_focus = AUH_unitary_monarchy
			has_completed_focus = AUH_reform_transleithania
		}
	}
	fire_only_once = yes
	mean_time_to_happen = {
		days = 1
	}
	option = {
		name = ww1_auh.17.a
		hidden_effect = {
			AUH_karl_von_pflanzerbaltin = {
				set_nationality = AUS
			}
			AUH_eduard_von_bohmermolli = {
				set_nationality = AUS
			}
			AUH_alois_schonburg_hartenstein = {
				set_nationality = AUS
			}
		}
		every_state = {
			limit = {
				OR = {
					AND = {
						is_core_of = AUH
						is_owned_by = AUH
					}
					state = 147
					state = 38
				}			
			}
			add_core_of = AUS
		}
		every_state = {
			limit = {
				is_core_of = AUH
			}
			remove_core_of = AUH
		}		
		every_state = {
			limit = {
				is_claimed_by = AUH
			}
			remove_claim_by = AUH
		}
		AUS = {
			annex_country = {
				target = AUH
				transfer_troops = no
			}
			set_country_flag = great_war_loser
			add_ideas = idea_armistice
			country_lock_all_division_template = no
			add_ideas = idea_army_restrictions
			add_timed_idea = {
				idea = GER_idea_reparations
				days = 365
			}
			inherit_technology = AUH
			hidden_effect = {
				load_oob = AUS_1918
			}
			if = {
				limit = {
					ITA = {
						NOT = {
							has_country_flag = great_war_winner
							owns_state = 244
						}
					}
				}
				transfer_state = 244
			}
			# German-Austria
			set_cosmetic_tag = AUS_AUH
			change_tag_from = AUH
		}
		# Austria is not giving South Tyrol and Zara, so I added this.
		if = {
			limit = {
				ITA = {
					has_country_flag = great_war_winner
				}
			}
			every_state = {
				limit = {
					OR = {
						is_owned_by = AUH
						is_owned_by = AUS
						is_owned_by = HUN
						is_owned_by = CRO
					}
					OR = {
						state = 39
						state = 163
						state = 244
						state = 736
					}
				}
				ITA = {
					transfer_state = PREV
				}
			}
		}
		news_event = {
			id = ww1_auh.18
		}
		hidden_effect = {
			set_global_flag = AUH_collapse
		}
		ai_chance = {
			factor = 100
		}
	}
}

# DEATH OF AUSTRIA - NEWS
#################
news_event = {
	id = ww1_auh.18
	title = ww1_auh.18.t
	desc = ww1_auh.18.d
	picture = GFX_news_event_ger_civil_war
	is_triggered_only = yes
	major = yes
	option = {
		name = ww1_auh.18.a
		ai_chance = {
			factor = 100
		}
	}
}

# HUNGARIAN REVOLT
#################
country_event = {
	id = ww1_auh.19
	title = ww1_auh.19.t
	desc = ww1_auh.19.d
	picture = GFX_report_event_ger_civil_war
	trigger = {
		original_tag = AUH
		has_completed_focus = AUH_ban_election_in_hungary
		HUN = {
			exists = no
		}
		OR = {
			AND = {
				has_war = yes
				has_stability < 0.25
			}
			has_stability < 0.35
		}
		any_owned_state = {
			is_core_of = HUN
		}
		NOT = {
			has_country_flag = great_war_loser
			has_global_flag = hungary_released
			has_war_with = GER
		}
	}
	fire_only_once = yes
	mean_time_to_happen = {
		days = 45
	}
	option = {
		name = ww1_auh.19.a
		hidden_effect = {
			set_global_flag = hungary_released
			set_global_flag = hungarian_revolution
		}
		if = {
			limit = {
				NOT = {
					has_cosmetic_tag = GER_confederation
					has_cosmetic_tag = GER_HRE
					has_cosmetic_tag = AUH_USGA
					has_cosmetic_tag = GER_suddeutscher_bund
				}
			}
			set_cosmetic_tag = AUH_EMP
		}
		HUN = {
			every_state = {
				limit = {
					is_owned_by = AUH
					is_core_of = HUN
					is_controlled_by = AUH
					NOT = {
						state = 778
					}
				}
				HUN = {
					transfer_state = PREV
				}
			}
			every_state = {
				limit = {
					is_owned_by = AUH
					is_core_of = HUN
					NOT = {
						state = 778
						is_controlled_by = AUH
					}
				}
				HUN = {
					set_state_owner = PREV
				}
			}
			hidden_effect = {
				drop_cosmetic_tag = yes
				load_oob = HUN_1918
				set_politics = {
					ruling_party = democratic
					elections_allowed = yes
				}
				set_popularities = {
					democratic = 40
					neutrality = 36
					fascism = 0
					communism = 24
				}
			}
			declare_war_on = {
				target = AUH
				type = civil_war
			}
		}
		ai_chance = {
			factor = 100
		}
	}
}

# BROTHERS WAR - NEWS
#################
news_event = {
	id = ww1_auh.20
	title = ww1_auh.20.t
	desc = ww1_auh.20.d
	picture = GFX_news_event_ger_civil_war
	fire_only_once = yes
	trigger = {
		GER = {
			has_war_with = AUH
			is_subject = no
		}
		AUH = {
			is_subject = no
		}
		has_global_flag = brothers_war
		NOT = {
			has_global_flag = brothers_war_ends
		}
	}
	major = yes
	option = {
		name = ww1_auh.20.a
	}
}

#Austrija odlučuje da li će da zahteva od Srbije da se povuče s obale
country_event = {
	id = ww1_auh.22
	title = ww1_auh.22.t
	desc = ww1_auh.22.d
	picture = GFX_report_event_yugoslavian_cavalry
	fire_only_once = yes
	trigger = {
		tag = AUH
		has_war = no
		is_subject = no
		SER = { owns_state = 44 }
	}
	mean_time_to_happen = {
		days = 1
	}
	option = {
		name = ww1_auh.22.a
		add_political_power = -75
		SER = { country_event = ww1_serbia.24 }
		ai_chance = {
			base = 60
			modifier = {
				add = 40
				has_war_support > 0.5
			}
		}
	}
	option = {
		name = ww1_auh.22.b
		SER = { set_country_flag = odbili_albaniju }
		ai_chance = {
			base = 20
			modifier = {
				add = 200
				has_subject = SER
			}
			modifier = {
				factor = 0
				has_game_rule = {
					rule = ultimatum_on_albania
					option = WAR_ON_ALBANIA
				}
			}
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
	}
}

# Serbia Rejected Our Ultimatum!
country_event = {
	id = ww1_auh.23
	title = ww1_auh.23.t
	desc = ww1_auh.23.d
	picture = GFX_report_event_generic_sign_treaty3
	is_triggered_only = yes
	fire_only_once = yes
	option = {
		name = ww1_auh.23.a
		create_wargoal = {
			type = puppet_wargoal_focus
			target = SER
		}
		RUS = {
			give_guarantee = SER
		}
		ai_chance = {
			base = 20
			modifier = {
				add = 40
				has_war_support > 0.5
			}
		}
	}
	option = {
		name = ww1_auh.23.b
		SER = { country_event = ww1_serbia.25 }
		ai_chance = {
			base = 50
			modifier = {
				factor = 0
				has_game_rule = {
					rule = ultimatum_on_albania
					option = WAR_ON_ALBANIA
				}
			}
		}
	}
}

# KINGDOM OF LOMBARDY-VENETIA
################################
country_event = {
	id = ww1_auh.24
	title = ww1_auh.24.t
	desc = ww1_auh.24.d
	fire_only_once = yes
	mean_time_to_happen = {
		days = 14
	}
	trigger = {
		tag = AUH
		OR = {
			owns_state = 159
			owns_state = 160
		}
	}
	option = {
		name = ww1_auh.24.a
		ai_chance = {
			factor = 100
		}
		every_owned_state = {
			limit = {
				OR = {
					state = 159
					state = 160
				}
			}
			hidden_effect = { add_core_of = VNC }
			transfer_state_to = VNC
		}
		if = {
			limit = {
				NOT = { has_subject = VNC }
			}
			if = {
				limit = {
					OR = {
						has_dlc = "Together for Victory"
						has_dlc = "Waking the Tiger"
					}
				}
				set_autonomy = {
					target = VNC
					autonomous_state = autonomy_tgwr_crownland
				}
				else = {
					puppet = VNC
				}
			}
		}
		hidden_effect = {
			VNC = {
				if = {
					limit = {
						NOT = {
							has_cosmetic_tag = ROI_neutrality
							has_cosmetic_tag = VNC_AUH
						}
					}
					set_cosmetic_tag = VNC_AUH
					VNC_eugen_von_osterreich_teschen = {
						add_country_leader_role = {
							promote_leader = yes
							country_leader = {
								ideology = oligarchism
								traits = { foreign_leader }
							}
						}
					}
					set_party_name = {
						ideology = neutrality 
						long_name = VNC_neutrality_AUH_party_long 
						name = VNC_neutrality_AUH_party 
					}
				}
			}
		}
		trigger = {
			OR = {
				has_subject = VNC
				NOT = { country_exists = VNC } 
			}
		}
	}
	option = {
		name = ww1_auh.24.b
		add_stability = -0.07
		add_manpower = -1000
		trigger = {
			has_stability > 0.07
			has_manpower > 1000
		}
		ai_chance = {
			base = 0
			modifier = {
				add = 75
				has_government = fascism
			}
		}
	}
}

# OCCUPATION OF LOMBARDY AND VENETO
#######################################
country_event = {
	id = ww1_auh.25
	title = ww1_auh.25.t
	desc = ww1_auh.25.d
	fire_only_once = yes
	mean_time_to_happen = {
		days = 7
	}
	trigger = {
		tag = AUH
		has_global_flag = italian_civil_war
		has_country_flag = great_war_winner
		has_war = no
		any_country = {
			original_tag = ITA
			has_country_flag = ITA_socialist_italy_flag
			has_war = yes
			is_neighbor_of = PREV
			NOT = {
				has_war_with = PREV
				is_in_faction_with = PREV
			}
			OR = {
				owns_state = 160
				owns_state = 159
			}
		}
	}
	option = {
		name = ww1_auh.25.a
		ai_chance = {
			factor = 100
		}
		add_war_support = 0.02
		add_political_power = -150
		add_named_threat = {
			threat = 2
			name = ww1_auh.25.t
		}
		VNC = {
			if = {
				limit = {
					is_subject_of = PREV
				}
				every_other_country = {
					limit = {
						original_tag = ITA
						has_country_flag = ITA_socialist_italy_flag
						has_war = yes
						is_neighbor_of = PREV
						NOT = {
							has_war_with = PREV
							is_in_faction_with = PREV
						}
						OR = {
							owns_state = 160
							owns_state = 159
						}
					}
					every_owned_state = {
						limit = {
							OR = {
								state = 159
								state = 160
							}
						}
						transfer_state_to = PREV.PREV
					}
				}
			}
			else = {
				PREV = {
					every_other_country = {
						limit = {
							original_tag = ITA
							has_country_flag = ITA_socialist_italy_flag
							has_war = yes
							is_neighbor_of = PREV
							NOT = {
								has_war_with = PREV
								is_in_faction_with = PREV
							}
							OR = {
								owns_state = 160
								owns_state = 159
							}
						}
						every_owned_state = {
							limit = {
								OR = {
									state = 159
									state = 160
								}
							}
							transfer_state_to = PREV.PREV
						}
					}
				}
			}
		}
		every_other_country = {
			limit = {
				OR = {
					original_tag = ITA
					original_tag = SIC
					original_tag = SRD
					original_tag = TUS
					original_tag = EMI
					original_tag = VNC
					original_tag = PAP
				}
				NOT = {
					is_in_faction_with = PREV
					is_subject_of = PREV
				}
			}
			news_event = ww1_auh.26
		}
	}
	option = {
		name = ww1_auh.25.b
		AUH = {
			add_war_support = -0.02
		}
	}
}

# OCCUPATION OF LOMBARDY AND VENETO - ITALIAN REACTION
#########################################################
news_event = {
	id = ww1_auh.26
	title = ww1_auh.26.t
	desc = ww1_auh.26.d
	picture = GFX_news_event_fascist_militia
	is_triggered_only = yes
	option = {
		name = ww1_auh.26.a
	}
}

# Remove cores or Promise autonomies
#####################################
country_event = {
	id = ww1_auh.27
	title = ww1_auh.27.t
	desc = ww1_auh.27.d
	fire_only_once = yes
	trigger = {
		tag = AUH
		has_global_flag = kis_war
		has_war_with = FRA
		has_stability < 0.75
		casualties > 800000
		any_owned_state = {
			OR = {
				is_core_of = POL
				is_core_of = CZE
				is_core_of = UKR
				is_core_of = CRO
			}
		}
		NOT = {
			has_completed_focus = AUH_federalism
		}
	}
	mean_time_to_happen = {
		days = 5
	}
	option = {
		name = ww1_auh.27.a
		AUH = {
			every_owned_state = {
				limit = {
					OR = {
						is_core_of = POL
						is_core_of = CZE
						is_core_of = UKR
						is_core_of = CRO
					}
				}
				remove_core_of = AUH
			}
		}
		add_stability = -0.2
		ai_chance = {
			factor = 0
		}
	}
	option = {
		name = ww1_auh.27.b
		AUH = {
			set_country_flag = austria_promised_autonomy
			add_stability = -0.1
		}
		ai_chance = {
			factor = 100
		}
	}
}

# Italy offered the surrender terms in Bruderkrieg
#############################
country_event = {
	id = ww1_auh.28
	title = ww1_auh.28.t
	desc = ww1_auh.28.d
	fire_only_once = yes
	is_triggered_only = yes
	option = {
		name = ww1_auh.28.a
		ITA = {
			leave_faction = yes
			white_peace = AUH
			if = {
				limit = {
					owns_state = 159
				}
				AUH = {
					transfer_state = 159
				}
			}
			if = {
				limit = {
					owns_state = 160
				}
				AUH = {
					transfer_state = 160
				}
			}
		}
		ai_chance = {
			base = 0
			modifier = {
				add = 100
				OR = {
					has_war_support < 0.5
					surrender_progress > 0.3
				}
			}
		}
	}
	option = {
		name = ww1_auh.28.b
		ai_chance = {
			base = 100
			modifier = {
				factor = 0
				OR = {
					has_war_support < 0.5
					surrender_progress > 0.3
				}
			}
		}
	}
}

# Italy is fully defeated in Bruderkrieg
#############################
country_event = {
	id = ww1_auh.29
	title = ww1_auh.29.t
	desc = ww1_auh.29.d
	fire_only_once = yes
	is_triggered_only = yes
	option = {
		name = ww1_auh.29.a
		ITA = {
			hidden_effect = {
				if = {
					limit = {
						owns_state = 159
					}
					AUH = {
						transfer_state = 159
					}
				}
				if = {
					limit = {
						owns_state = 160
					}
					AUH = {
						transfer_state = 160
					}
				}
				SIC = {
					add_state_core = 115
					add_state_core = 117
					add_state_core = 156
				}
				TUS = {
					add_state_core = 162
				}
				EMI = {
					add_state_core = 833
				}
				PAP = {
					add_state_core = 2
					add_state_core = 157
					add_state_core = 161
					add_state_core = 835
				}
				SRD = {
					add_state_core = 114
					add_state_core = 158
					add_state_claim = 735
					add_state_claim = 834
					set_cosmetic_tag = SRD_PIE
					set_capital = { state = 158 }
				}
				every_state = {
					limit = {
						is_core_of = SRD
						is_owned_by = ITA
					}
					SRD = {
						transfer_state = PREV
					}
				}
				SRD = {
					change_tag_from = ITA
				}
				every_state = {
					limit = {
						is_core_of = SIC
						is_owned_by = ITA
					}
					SIC = {
						transfer_state = PREV
					}
				}
				transfer_units_fraction = {
					target = SRD
					size = 0.5
					stockpile_ratio = 0.5
					army_ratio = 0.5
					navy_ratio = 0.5
					air_ratio = 0.5
				}
				transfer_units_fraction = {
					target = SIC
					size = 1
					stockpile_ratio = 1
					army_ratio = 1
					navy_ratio = 1
					air_ratio = 1
				}
				every_state = {
					limit = {
						is_core_of = TUS
						is_owned_by = ITA
					}
					TUS = {
						transfer_state = PREV
					}
				}
				every_state = {
					limit = {
						is_core_of = EMI
						is_owned_by = ITA
					}
					EMI = {
						transfer_state = PREV
					}
				}
				every_state = {
					limit = {
						is_core_of = PAP
						is_owned_by = ITA
					}
					PAP = {
						transfer_state = PREV
					}
				}
				AUH = {
					if = {
						limit = {
							has_dlc = "Together for Victory"
						}
						set_autonomy = {
							target = SRD
							autonomous_state = autonomy_dominion
						}
					}
					else = {
						puppet = SRD
					}
					if = {
						limit = {
							has_dlc = "Together for Victory"
						}
						set_autonomy = {
							target = SIC
							autonomous_state = autonomy_dominion
						}
					}
					else = {
						puppet = SIC
					}
					if = {
						limit = {
							has_dlc = "Together for Victory"
						}
						set_autonomy = {
							target = PAP
							autonomous_state = autonomy_tgwr_protectorate
						}
					}
					else = {
						puppet = PAP
					}
					puppet = TUS
					puppet = EMI
					add_ai_strategy = {
						type = protect
						id = "SRD"
						value = 200
					}
					add_ai_strategy = {
						type = consider_weak
						id = "SRD"
						value = 200
					}
					add_ai_strategy = {
						type = protect
						id = "TUS"
						value = 200
					}
					add_ai_strategy = {
						type = consider_weak
						id = "TUS"
						value = 200
					}
					add_ai_strategy = {
						type = protect
						id = "VNC"
						value = 200
					}
					add_ai_strategy = {
						type = consider_weak
						id = "VNC"
						value = 200
					}
					add_ai_strategy = {
						type = protect
						id = "EMI"
						value = 200
					}
					add_ai_strategy = {
						type = consider_weak
						id = "EMI"
						value = 200
					}
					add_ai_strategy = {
						type = protect
						id = "SIC"
						value = 200
					}
					add_ai_strategy = {
						type = consider_weak
						id = "SIC"
						value = 200
					}
					add_ai_strategy = {
						type = protect
						id = "PAP"
						value = 200
					}
					add_ai_strategy = {
						type = consider_weak
						id = "PAP"
						value = 200
					}
				}
				every_state = {
					limit = {
						is_owned_by = ITA
						NOT = {
							is_core_of = ITA
						}
					}
					AUH = {
						transfer_state = PREV
					}
				}
			}
		}
		if = {
			limit = {
				any_country = {
					exists = yes
					has_country_flag = joined_brothers_war
				}
			}
			hidden_effect = {
				every_other_country = {
					limit = {
						exists = yes
						has_country_flag = joined_brothers_war
						NOT = {
							has_war_with = PREV
						}
					}
					every_owned_state = {
						limit = {
							OR = {
								is_core_of = PREV.PREV
								is_claimed_by = PREV.PREV
							}
						}
						PREV.PREV = {
							transfer_state = PREV
						}
					}
					PREV = {
						puppet = PREV
					}
				}
			}
		}
		ai_chance = {
			factor = 100
		}
	}
}

# Austro-Hungarian Aftermath
## When they have managed to keep the empire.
##################################
country_event = {
	id = ww1_auh.32
	trigger = {
		original_tag = AUH
		has_country_flag = great_war_loser
		has_global_flag = hungary_released
		has_global_flag = croatia_released
		has_global_flag = czechoslovakia_released
		has_global_flag = galicia_released
		NOT = {
			has_global_flag = AUH_collapse
		}
		OR = {
			has_completed_focus = AUH_unitary_monarchy
			has_completed_focus = AUH_reform_transleithania
		}
	}
	fire_only_once = yes
	mean_time_to_happen = {
		days = 1
	}
	hidden = yes
	immediate = {
		every_state = {
			limit = {
				is_core_of = ROOT
				NOT = {
					is_owned_by = ROOT
					state = 39
					state = 69
					state = 74
					state = 147
				}
			}
			remove_core_of = ROOT
		}
		every_state = {
			limit = {
				is_claimed_by = ROOT
			}
			remove_claim_by = ROOT
		}
		add_timed_idea = {
			idea = GER_idea_reparations
			days = 365
		}
		every_state = {
			teleport_armies = {
				limit = {
					tag = ROOT
				}
				to_state = 4
			}
		}
		delete_unit = {
			state = 4
			disband = yes
		}
		set_equipment_fraction = 0.3
		load_oob = AUS_1918
		if = {
			limit = {
				ITA = {
					has_country_flag = great_war_winner
				}
			}
			every_state = {
				limit = {
					OR = {
						is_owned_by = AUH
						is_owned_by = HUN
						is_owned_by = CRO
					}
					OR = {
						state = 39
						state = 163
						state = 244
						state = 736
					}
				}
				ITA = {
					transfer_state = PREV
				}
			}
		}
		set_global_flag = AUH_collapse
	}
}

# Abdication of Karl I
#########################
country_event = {
	id = ww1_auh.33
	title = ww1_auh.33.t
	desc = ww1_auh.33.d
	trigger = {
		OR = {
			tag = AUH
			tag = AUS
		}
		NOT = {
			has_country_flag = AUH_franz_ferdinand_i_abdicated
		}
		OR = {
			has_country_leader = {
				character = AUH_karl_i
				ruling_only = yes
			}
			has_country_leader = {
				character = AUS_karl_i
				ruling_only = yes
			}
		}
		has_country_flag = great_war_loser
		has_global_flag = interbellum
	}
	mean_time_to_happen = {
		days = 267
	}
	fire_only_once = yes
	option = {
		name = ww1_auh.33.a
		trigger = {
			tag = AUH
		}
		AUH_otto_von_habsburg = {
			add_country_leader_role = {
				country_leader = {
					ideology = autocracy
				}
			}
			promote_character = autocracy
		}
		if = {
			limit = {
				NOT = { date > 1932.11.20 }
			}
			AUH_zita_von_bourbonparma = {
				add_country_leader_role = {
					country_leader = {
						ideology = autocracy
					}
				}
				set_character_name = "AUH_zita"
				promote_character = autocracy
			}
		}
		hidden_effect = {
			HUN = {
				if = {
					limit = {
						has_country_leader = {
							character = HUN_karl_i
						}	
					}
					HUN_otto_von_habsburg = {
						add_country_leader_role = {
							country_leader = {
								ideology = autocracy
							}
						}
						promote_character = autocracy
					}
					if = {
						limit = {
							NOT = { date > 1932.11.20 }
						}
						HUN_zita_von_bourbonparma = {
							add_country_leader_role = {
								country_leader = {
									ideology = autocracy
								}
							}
							promote_character = autocracy
						}
					}
				}
				retire_character = HUN_karl_i
			}
		}
	}
	option = {
		name = ww1_auh.33.b
		trigger = {
			tag = AUS
		}
		AUS_otto_von_habsburg = {
			add_country_leader_role = {
				country_leader = {
					ideology = autocracy
				}
			}
			promote_character = autocracy
		}
		if = {
			limit = {
				NOT = { date > 1932.11.20 }
			}
			AUS_zita_von_bourbonparma = {
				add_country_leader_role = {
					country_leader = {
						ideology = autocracy
					}
				}
				promote_character = autocracy
			}
		}
		hidden_effect = {
			HUN = {
				if = {
					limit = {
						has_country_leader = {
							character = HUN_karl_i
						}	
					}
					HUN_otto_von_habsburg = {
						add_country_leader_role = {
							country_leader = {
								ideology = autocracy
							}
						}
						promote_character = autocracy
					}
					if = {
						limit = {
							NOT = { date > 1932.11.20 }
						}
						HUN_zita_von_bourbonparma = {
							add_country_leader_role = {
								country_leader = {
									ideology = autocracy
								}
							}
							promote_character = autocracy
						}
					}
				}
				retire_character = HUN_karl_i
			}
		}
	}
}

# End of Regency (Otto von Habsburg)
########################################
country_event = {
	id = ww1_auh.34
	title = ww1_auh.34.t
	desc = ww1_auh.34.d
	trigger = {
		OR = {
			tag = AUH
			tag = AUS
		}
		OR = {
			has_country_leader = {
				character = AUH_zita_von_bourbonparma
				ruling_only = yes
			}
			has_country_leader = {
				character = AUS_zita_von_bourbonparma
				ruling_only = yes
			}
		}
		# On his twentieth birthday
		date > 1932.11.1
	}
	mean_time_to_happen = {
		days = 20
	}
	fire_only_once = yes
	option = {
		name = ww1_auh.34.a
		hidden_effect = {
			if = {
				limit = {
					tag = AUH
				}
				retire_character = AUH_zita_von_bourbonparma
				AUH_otto_von_habsburg = {
					set_character_name = "AUH_franz_joseph_ii"
					promote_character = autocracy
				}
				else_if = {
					limit = {
						tag = AUS
					}
					retire_character = AUS_zita_von_bourbonparma
					AUS_otto_von_habsburg = {
						promote_character = autocracy
					}
				}
			}
			HUN = {
				if = {
					limit = {
						has_country_leader = {
							character = HUN_zita_von_bourbonparma
						}	
					}
					HUN_otto_von_habsburg = {
						set_character_name = "HUN_franz_joseph_ii"
						add_country_leader_role = {
							country_leader = {
								ideology = autocracy
							}
						}
						promote_character = autocracy
					}
				}
				retire_character = HUN_zita_von_bourbonparma
			}
		}
		effect_tooltip = {
			AUH_otto_von_habsburg = {
				set_character_name = AUH_franz_joseph_ii
				add_country_leader_role = {
					promote_leader = yes
					country_leader = {
						ideology = autocracy
					}
				}
			}
		}
	}
}

# Promised Autonomy
######################
country_event = {
	id = ww1_auh.35
	title = ww1_auh.35.t
	desc = ww1_auh.35.d
	fire_only_once = yes
	mean_time_to_happen = {
		days = 20
	}
	trigger = {
		original_tag = AUH
		has_global_flag = great_war_ends
		OR = {
			has_global_flag = versallies_treaty
			has_global_flag = frankfurt_treaty
		}
		has_country_flag = great_war_winner
		has_country_flag = austria_promised_autonomy
		has_war = no
	}
	option = {
		name = ww1_auh.35.a
		if = {
			limit = {
				CZE = {
					exists = no
				}
				any_owned_state = {
					is_core_of = CZE
				}
			}	
			every_owned_state = {
				limit = {
					is_core_of = CZE
				}
				transfer_state_to = CZE
			}
			if = {
				limit = {
					OR = {
						has_dlc = "Together for Victory"
						has_dlc = "Waking the Tiger"
					}
				}
				set_autonomy = {
					target = CZE
					autonomous_state = autonomy_tgwr_crownland
				}
				else = {
					puppet = CZE
				}
			}
			hidden_effect = {
				add_ai_strategy = {
					type = protect
					id = "CZE"
					value = 50
				}
				CRO = {
					set_cosmetic_tag = CRO_AUH
				}
			}			
		}
		if = {
			limit = {
				GAL = {
					exists = no
				}
				any_owned_state = {
					is_core_of = GAL
				}
			}	
			every_owned_state = {
				limit = {
					OR = {
						is_core_of = GAL
						state = 80
						state = 867
					}	
				}
				transfer_state_to = GAL
			}
			if = {
				limit = {
					OR = {
						has_dlc = "Together for Victory"
						has_dlc = "Waking the Tiger"
					}
				}
				set_autonomy = {
					target = GAL
					autonomous_state = autonomy_tgwr_crownland
				}
				else = {
					puppet = GAL
				}
			}
			add_ai_strategy = {
				type = protect
				id = "GAL"
				value = 50
			}
		}
		if = {
			limit = {
				CRO = {
					exists = no
				}
				any_owned_state = {
					OR = {
						is_core_of = CRO
						is_core_of = MNT
						is_core_of = BOS
						is_core_of = SER
					}
					NOT = {
						is_core_of = SLV
						is_core_of = HUN
					}
				}
			}	
			every_owned_state = {
				limit = {
					OR = {
						is_core_of = CRO
						is_core_of = MNT
						is_core_of = BOS
						is_core_of = SER
					}
					NOT = {
						is_core_of = SLV
						is_core_of = HUN
					}
				}
				add_core_of = CRO
				transfer_state_to = CRO
			}
			if = {
				limit = {
					OR = {
						has_dlc = "Together for Victory"
						has_dlc = "Waking the Tiger"
					}
				}
				set_autonomy = {
					target = CRO
					autonomous_state = autonomy_tgwr_crownland
				}
				else = {
					puppet = CRO
				}
			}
			hidden_effect = {
				CRO = {
					set_cosmetic_tag = CRO_AUH
				}
				add_ai_strategy = {
					type = protect
					id = "CRO"
					value = 50
				}
			}		
		}
		if = {
			limit = {
				HUN = {
					exists = no
				}
				any_owned_state = {
					is_core_of = HUN
				}
			}	
			every_owned_state = {
				limit = {
					OR = {
						is_core_of = HUN
						is_claimed_by = HUN
						is_core_of = TRA
					}
				}
				transfer_state_to = HUN
			}
			if = {
				limit = {
					OR = {
						has_dlc = "Together for Victory"
						has_dlc = "Waking the Tiger"
					}
				}
				set_autonomy = {
					target = HUN
					autonomous_state = autonomy_tgwr_crownland
				}
				else = {
					puppet = HUN
				}
			}
			hidden_effect = {		
				AUH_HUN_create_habsburg = yes		
				HUN =  { load_oob = "HUN_1918" }		
				add_ai_strategy = {
					type = protect
					id = "HUN"
					value = 50
				}
			}
			if = {
				limit = {
					NOT = {
						has_cosmetic_tag = GER_confederation
						has_cosmetic_tag = GER_HRE
						has_cosmetic_tag = GER_suddeutscher_bund
					}
				}
				set_cosmetic_tag = AUH_EMP
			}
		}	
		add_political_power = -200
		add_stability = 0.1
		news_event = ww1_auh.42
	}
}

# Germany is fully defeated in Bruderkrieg
#############################################
country_event = {
	id = ww1_auh.36
	title = ww1_auh.36.t
	desc = ww1_auh.36.d
	fire_only_once = yes
	is_triggered_only = yes
	option = {
		name = ww1_auh.36.a
		GER = {
			hidden_effect = {
				every_owned_state = {
					limit = {
						OR = {
							is_core_of = BAY
							is_core_of = WUR
						}
					}
					AUH = {
						add_state_core = PREV
						transfer_state = PREV
						set_cosmetic_tag = GER_suddeutscher_bund
						create_faction = danube_adriabund
						set_capital = { state = 4 }
					}
				}
				set_cosmetic_tag = GER_norddeutscher_bund
				create_country_leader = {
 					name = "GER_frankfurt_parliament"
 					picture = "gfx/leaders/GER/GER_Frankfurt_Parliament.png"
 					ideology = oligarchism
 				}
 				set_capital = { state = 55 }
 				set_party_name = { 
 					ideology = neutrality
 					long_name = GER_frankfurt_parliament
 					name = GER_frankfurt_parliament
 				}
				AUH = {
					if = {
						limit = {
							has_dlc = "Together for Victory"
						}
						set_autonomy = {
							target = GER
							autonomous_state = autonomy_dominion
						}
					}
					else = {
						puppet = GER
					}
					add_ai_strategy = {
						type = protect
						id = "GER"
						value = 200
					}
				}
			}
		}
		if = {
			limit = {
				has_global_flag = bosnian_revolt
			}
			hidden_effect = {
				if = {
					limit = {
						CRO = {
							is_subject_of = AUH
						}
					}
					CRO = {
						annex_country = {
							target = BOS
							transfer_troops = no
						}
					}
				}
				else = {
					AUH = {
						annex_country = {
							target = BOS
							transfer_troops = no
						}
					}
				}
			}
		}
		if = {
			limit = {
				any_country = {
					exists = yes
					has_country_flag = joined_brothers_war
				}
			}
			hidden_effect = {
				every_other_country = {
					limit = {
						exists = yes
						has_country_flag = joined_brothers_war
						NOT = {
							has_war_with = PREV
						}
					}
					every_owned_state = {
						limit = {
							OR = {
								is_core_of = PREV.PREV
								is_claimed_by = PREV.PREV
							}
						}
						PREV.PREV = {
							transfer_state = PREV
						}
					}
					PREV = {
						puppet = PREV
					}
				}
			}
		}
		ai_chance = {
			factor = 100
		}
	}
}

# You cannot have non-German cores with German identity
##################################################################
country_event = {
	id = ww1_auh.37
	title = ww1_auh.37.t
	desc = ww1_auh.37.d
	fire_only_once = yes
	mean_time_to_happen = {
		days = 20
	}
	trigger = {
		original_tag = AUH
		has_war = no
		OR = {
			has_cosmetic_tag = GER_confederation
			has_cosmetic_tag = GER_HRE
			has_cosmetic_tag = GER_suddeutscher_bund
		}
		any_owned_state = {
			is_core_of = AUH
			OR = {
				is_core_of = HUN
				is_core_of = GAL
				is_core_of = CRO
				is_core_of = BOS
				is_core_of = TRA
				is_core_of = ROM
				is_core_of = POL
				is_core_of = UKR
				is_core_of = SER
				is_core_of = ITA
				is_core_of = SLV
			}
			NOT = {
				state = 72 # Zaolzie
				state = 39 # Südtirol
				state = 147 # Burgenland
			}
		}
	}
	option = {
		name = ww1_auh.37.a
		every_state = {
			limit = {
				is_core_of = AUH
				OR = {
					is_core_of = HUN
					is_core_of = GAL
					is_core_of = CRO
					is_core_of = BOS
					is_core_of = TRA
					is_core_of = ROM
					is_core_of = POL
					is_core_of = UKR
					is_core_of = SER
					is_core_of = ITA
					is_core_of = SLV
				}
				NOT = {
					state = 72 # Zaolzie
					state = 39 # Südtirol
					state = 147 # Burgenland
				}
			}
			remove_core_of = AUH
		}
	}
}

# Abdication of Franz Ferdinand I
####################################
country_event = {
	id = ww1_auh.38
	title = ww1_auh.38.t
	desc = ww1_auh.38.d
	trigger = {
		tag = AUH
		has_country_flag = great_war_loser
		has_country_leader = {
			character = AUH_franz_ferdinand_i
			ruling_only = yes
		}
		has_global_flag = interbellum
		NOT = { has_global_flag = austrian_emperor_abdicated }
	}
	fire_only_once = yes
	mean_time_to_happen = {
		days = 40
	}
	immediate = {
		hidden_effect = {
			set_global_flag = austrian_emperor_abdicated
			AUH = {
				if = {
					limit = {
						has_country_leader = {
							character = AUH_karl_i
						}
					}
					AUH_karl_i = {
						set_character_name = "AUH_karl_i"
						promote_character = autocracy
						if = {
							limit = {
								is_field_marshal = no									
							}
							promote_leader = yes
						}
					}
				}
				retire_character = AUH_franz_ferdinand_i
				set_country_flag = franz_ferdinand_i_abdicated
			}
			HUN = {
				if = {
					limit = {
						has_country_leader = {
							character = HUN_karl_i
						}	
					}
					promote_character = HUN_karl_i
				}
				retire_character = HUN_franz_ferdinand_i
				set_country_flag = franz_ferdinand_i_abdicated
			}
			AUS = {
				if = {
					limit = {
						has_country_leader = {
							character = AUS_karl_i
						}	
					}
					promote_character = AUS_karl_i
				}
				retire_character = AUS_franz_ferdinand_i
				set_country_flag = franz_ferdinand_i_abdicated
			}
		}
	}
	option = {
		name = ww1_auh.38.a
		ai_chance = { factor = 100 }
		effect_tooltip = {
			AUH_karl_i = {
				set_character_name = AUH_karl_i
				add_country_leader_role = {
					promote_leader = yes
					country_leader = {
						ideology = autocracy
					}
				}
			}
		}
	}
}

# Capital of the Greater Germany
##################################################################
country_event = {
	id = ww1_auh.39
	title = ww1_auh.39.t
	desc = ww1_auh.39.d
	fire_only_once = yes
	mean_time_to_happen = {
		days = 3
	}
	trigger = {
		original_tag = AUH
		has_war = no
		OR = {
			has_cosmetic_tag = GER_confederation
			has_cosmetic_tag = GER_HRE
		}
		capital_scope = { state = 4 }
		owns_state = 55 # Frankfurt
		owns_state = 53 # Regensburg
		owns_state = 4 # Vienna
	}
	option = {
		ai_chance = { factor = 1 } #move capital to Frankfurt
		name = ww1_auh.39.a
		set_capital = {state = 55}
		add_stability = 0.05
		add_popularity = {
			ideology = democratic
			popularity = 0.05
		}
	}
	option = {
		ai_chance = { factor = 1 } #move capital to Regensburg
		name = ww1_auh.39.b
		set_capital = {state = 53}
		add_popularity = {
			ideology = neutrality
			popularity = 0.05
		}
	}
	option = {
		ai_chance = { factor = 1 } #leave capital in Vienna
		name = ww1_auh.39.c
		add_stability = -0.05
		add_popularity = {
			ideology = neutrality
			popularity = 0.1
		}
	}
}

# OLD ALLY IS IN DANGER FACING THE RED TIDE
##############################################
country_event = {
	id = ww1_auh.41
	title = ww1_auh.t
	desc = ww1_auh.d
	trigger = {
		tag = AUH
		has_global_flag = interbellum
		has_country_flag = great_war_winner
		has_war = no
		NOT = {
			has_government = communism
			is_in_faction_with = GER
		}
		GER = {
			has_country_flag = great_war_winner
			NOT = {
				has_government = communism
			}
			any_other_country = {
				is_major = yes
				OR = {
					has_government = communism
					has_government = fascism
				}
				has_war_with = GER
			}
			surrender_progress > 0.5
		}
	}
	fire_only_once = yes
	mean_time_to_happen = { days = 15 }
	option = {
		name = ww1_auh.41.a
		GER = {
			#not sure with this
			#add_to_faction = AUH
			every_other_country = {
				limit = {
					is_major = yes
					OR = {
						has_government = communism
						has_government = fascism
					}
					has_war_with = PREV
				}
				PREV.PREV = {
					create_wargoal = {
						target = PREV
						type = topple_government
					}
				}
			}
		}
		ai_chance = {
			base = 0
			modifier = {
				add = 1000
				NOT = {
					has_stability < 0.25
					has_war_support < 0.25
					communism > 0.5
					has_opinion = {
						target = GER
						value < 0
					}
				}
			}
		}
	}
	option = {
		name = ww1_auh.41.b
		GER = {
			add_opinion_modifier = {
				target = PREV
				modifier = HOI4TGW_Opinion_alliance_malus
			}
		}
		ai_chance = {
			base = 1
			modifier = {
				factor = 0
				OR = {
					has_stability < 0.25
					has_war_support < 0.25
					communism > 0.5
					has_opinion = {
						target = GER
						value < 0
					}
				}
			}
		}
	}
}

# Austria-Hungary Undertakes National Reforms
news_event = {
	id = ww1_auh.42
	title = ww1_auh.42.t
	desc = ww1_auh.42.d
	picture = GFX_news_event_generic_parliament
	major = yes
	is_triggered_only = yes
	option = {
		name = ww1_auh.42.a
	}
}
