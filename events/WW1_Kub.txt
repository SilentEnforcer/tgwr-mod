add_namespace = ww1_kub

#Soviet Invasion - SOV
country_event = {
	title = ww1_kub.1.t
	desc = ww1_kub.1.d
	id = ww1_kub.1
	picture = GFX_report_event_royal_parade
	fire_only_once = yes
    trigger = {
		tag = SOV
		KUB = {
			has_capitulated = yes
		}
	}
	mean_time_to_happen = {
		days = 3
	}
	option = {
		name = ww1_kub.1.a	
		hidden_effect = {
			KUB = {
				load_focus_tree = empty_focus
				set_politics = {
					ruling_party = communism
					elections_allowed = no
				}
				add_popularity = {
					ideology = communism
					popularity = 0.25
				}
				set_country_flag = KUB_soviet_tag
				country_lock_all_division_template = yes
			}
			SOV = {
				puppet = KUB
				add_to_faction = KUB
			}
			BSR = {
				transfer_state = 233
				transfer_state = 940
			}
		}
	}
}
#black sea sr 
country_event = {
	title = ww1_kub.2.t
	desc = ww1_kub.2.d
	id = ww1_kub.2
	picture = GFX_report_event_royal_parade
	fire_only_once = yes
    is_triggered_only = yes
	option = {
		name = ww1_kub.2.a	
		hidden_effect = {
			KUB = {
				start_civil_war = {
					ideology = communism
					size = 0
					capital = 940
					states = {
						233
						940
					}
					create_country_leader = {
						name = SOV_abram_rubin
						picture = "gfx/leaders/SOV/Portrait_Soviet_Generic_1.dds"
						ideology = vanguardism
					}
					set_party_name = {
						ideology = communism
						long_name = SOV_communism_party_long
						name = SOV_communism_party
					}
					keep_all_characters = yes
					set_country_flag = KUB_black_sea_tag
					set_cosmetic_tag = BSR_communism
					load_focus_tree = empty_focus
					add_ideas = SOV_idea_red_guard
					division_template = {
						name = "Red Guards"
						division_names_group = SOV_INF_01
						regiments = {
							militia = { x = 0 y = 0 }
							militia = { x = 0 y = 1 }
							militia = { x = 1 y = 0 }
							militia = { x = 1 y = 1 }
						}
					}
					940 = {
						create_unit = {
							division = "division_template = \"Red Guards\" start_experience_factor = 0.2" 
							owner = BSR
							allow_spawning_on_enemy_provs = yes
							count = 1
						}
					}
					country_lock_all_division_template = yes
				}
			}
			234 = {
				remove_core_of = BSR
			}
			SOV = {
				puppet = BSR
				add_to_faction = BSR
			}
		}
	}
}
# Terek SR
country_event = {
	title = ww1_kub.3.t
	desc = ww1_kub.3.d
	id = ww1_kub.3
	picture = GFX_report_event_royal_parade
	fire_only_once = yes
    is_triggered_only = yes
	option = {
		name = ww1_kub.3.a	
		hidden_effect = {
			TER = {
				transfer_state = 232
				add_state_core = 232
				SOV = {
					puppet = PREV
				}
				retire_character = TER_mikhail_karaulov
				set_politics = {
					ruling_party = communism
				}
				set_popularities = {
					communism = 33
					democratic = 26
					neutrality = 31
					fascism = 10
				}
				add_ideas = SOV_idea_red_guard
				set_country_flag = dont_trigger_political_event
				load_focus_tree = empty_focus
				add_ideas = SOV_idea_red_guard
				country_lock_all_division_template = yes
				division_template = {
					name = "Krasnaya Gvardiya"
					division_names_group = SOV_INF_01
					regiments = {
						militia = { x = 0 y = 0 }
						militia = { x = 0 y = 1 }
						militia = { x = 1 y = 0 }
					}
				}
				232 = {
					create_unit = {
						division = "division_template = \"Krasnaya Gvardiya\" start_experience_factor = 0.2" 
						owner = PREV
						allow_spawning_on_enemy_provs = yes
						count = 4
					}
				}
			}
		}
	}
}
#testtesttest stavropol sr -- WORKING
country_event = {
	title = ww1_kub.4.t
	desc = ww1_kub.4.d
	id = ww1_kub.4
	picture = GFX_report_event_royal_parade
	fire_only_once = yes
    is_triggered_only = yes
	option = {
		name = ww1_kub.4.a	
		hidden_effect = {
			create_dynamic_country = {
				original_tag = RUS
				copy_tag = SOV
				add_political_power = 100
				transfer_state = 235
				load_focus_tree = empty_focus
				country_lock_all_division_template = yes
				SOV = {
					puppet = PREV
				}
				set_politics = {
					ruling_party = communism
					long_name = SOV_communism_party_long
					name = SOV_communism_party
					elections_allowed = no
				}
				set_popularities = {
					communism = 55
					democratic = 45
				}
				set_party_name = {
					ideology = democratic
					long_name = RUS_democratic_party_SR_long
					name = RUS_democratic_party_SR
				}
				set_country_flag = RUS_stavropol_tag
				set_cosmetic_tag = STV_communism
				add_ideas = SOV_idea_red_guard
				set_country_flag = dont_trigger_political_event
				create_country_leader = {
					name = SOV_aleksandr_ponomarev
					picture = GFX_Portrait_Soviet_Generic_land_2
					ideology = vanguardism
				}
				division_template = {
					name = "Red Guards"
					division_names_group = SOV_INF_01
					regiments = {
						militia = { x = 0 y = 0 }
						militia = { x = 0 y = 1 }
						militia = { x = 1 y = 0 }
						militia = { x = 1 y = 1 }
					}
				}
				235 = {
					create_unit = {
						division = "division_template = \"Red Guards\" start_experience_factor = 0.2" 
						owner = PREV
						allow_spawning_on_enemy_provs = yes
						count = 2
					}
				}
				every_state = {
					limit = {
						is_claimed_by = PREV
					}
					remove_claim_by = PREV
				}
				every_state = {
					limit = {
						is_core_of = PREV
						NOT = {
							state = 235
						}	
					}
					remove_core_of = PREV
				}
			}
			235 = {
				remove_core_of = SOV
			}
		}
	}
}

#amur sr -- WORKING
country_event = {
	title = ww1_kub.5.t
	desc = ww1_kub.5.d
	id = ww1_kub.5
	picture = GFX_report_event_royal_parade
	fire_only_once = yes
    is_triggered_only = yes
	option = {
		name = ww1_kub.5.a	
		hidden_effect = {
			AMU = {
				transfer_state = 561
				add_state_core = 561
				SOV = {
					puppet = PREV
				}
				set_politics = {
					ruling_party = communism
				}
				set_popularities = {
					neutrality = 20
					democratic = 50
					communism = 30
				}
				add_ideas = SOV_idea_red_guard
				set_country_flag = dont_trigger_political_event
				load_focus_tree = empty_focus
				country_lock_all_division_template = yes
				division_template = {
					name = "Krasnaya Gvardiya"
					regiments = {
						militia = { x = 0 y = 0 }
						militia = { x = 0 y = 1 }
						militia = { x = 1 y = 0 }
					}
					priority = 0
					is_locked = yes
				}
				division_template = {
					name = "Matrosy amurskoy flotilii"
					regiments = {
						marine = { x = 0 y = 0 }
						marine = { x = 0 y = 1 }
					}
					is_locked = yes
				}
				capital_scope = {
					create_unit = {
						division = "name = \"Matrosy amurskoy flotilii\" division_template = \"Matrosy amurskoy flotilii\" start_experience_factor = 0.2 start_equipment_factor = 0.5"
						owner = CONTROLLER
					}
					create_unit = {
						division = "name = \"Krasnaya Gvardiya\" division_template = \"Krasnaya Gvardiya\" start_experience_factor = 0.1 start_equipment_factor = 0.5"
						owner = CONTROLLER
					}
					create_unit = {
						division = "name = \"Krasnaya Gvardiya\" division_template = \"Krasnaya Gvardiya\" start_experience_factor = 0.1 start_equipment_factor = 0.5"
						owner = CONTROLLER
					}
					create_unit = {
						division = "name = \"Krasnaya Gvardiya\" division_template = \"Krasnaya Gvardiya\" start_experience_factor = 0.1 start_equipment_factor = 0.5"
						owner = CONTROLLER
					}
					create_unit = {
						division = "name = \"Krasnaya Gvardiya\" division_template = \"Krasnaya Gvardiya\" start_experience_factor = 0.1 start_equipment_factor = 0.5"
						owner = CONTROLLER
					}
					create_unit = {
						division = "name = \"Krasnaya Gvardiya\" division_template = \"Krasnaya Gvardiya\" start_experience_factor = 0.1 start_equipment_factor = 0.5"
						owner = CONTROLLER
					}
				}
			}
		}
	}
}

#kuban-black sea sr
# reworked in the name of father silent
country_event = {
	title = ww1_kub.6.t
	desc = ww1_kub.6.d
	id = ww1_kub.6
	picture = GFX_report_event_royal_parade
	fire_only_once = yes
    trigger = {
		tag = KUB
		has_government = communism
		is_in_faction_with = SOV
	}
	mean_time_to_happen = {
		days = 20
	}
	option = {
		name = ww1_kub.6.a	
		hidden_effect = {
			annex_country = {
				target = BSR
				transfer_troops = yes
			}
			every_state = {
				limit = {
					OR = {
						is_core_of = BSR
					}
				}
				add_core_of = KUB
				remove_core_of = BSR
			}
			set_cosmetic_tag = KUB_black_sea_communism
			country_event = {
				id = ww1_kub.7
				days = 1
			}
		}
	}
}

#north caucasus sr 
country_event = {
	title = ww1_kub.7.t
	desc = ww1_kub.7.d
	id = ww1_kub.7
	picture = GFX_report_event_royal_parade
	fire_only_once = yes
    is_triggered_only = yes
	option = {
		name = ww1_kub.7.a	
		hidden_effect = {
			set_cosmetic_tag = KUB_north_caucasus_communism
			create_country_leader = {
				name = SOV_abram_rubin
				picture = "gfx/leaders/SOV/Portrait_Soviet_Generic_1.dds"
				ideology = vanguardism
			}
			every_state = {
				limit = {
					OR = {
						is_core_of = STV
						is_core_of = TER
					}
				}
				add_core_of = KUB
				remove_core_of = STV
				remove_core_of = TER
			}
			annex_country = {
				target = TER
				transfer_troops = yes
			}
			annex_country = {
				target = STV
				transfer_troops = yes
			}
		}
	}
}

# north caucasus sr gets annexed
country_event = {
	title = ww1_kub.8.t
	desc = ww1_kub.8.d
	id = ww1_kub.8
	picture = GFX_report_event_royal_parade
	fire_only_once = yes
    trigger = {
		tag = SOV
		KUB = {
			is_in_faction_with = SOV
			surrender_progress > 0.9
			has_cosmetic_tag = KUB_north_caucasus_communism
		}
	}
	mean_time_to_happen = {
		days = 3
	}
	option = {
		name = ww1_kub.8.a	
		hidden_effect = {
			annex_country = {
				target = KUB
				transfer_troops = yes
			}
			every_state = {
				limit = {
					OR = {
						is_core_of = KUB
					}
				}
				add_core_of = SOV
				remove_core_of = KUB
			}
		}
	}
}