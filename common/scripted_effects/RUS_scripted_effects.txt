constituent_assembly_effect = {
	if = {
		limit = {
			check_variable = {
				var = vote_to_puppet_former_territories
				value = vote_to_let_former_territories
				compare = greater_than
			}
			check_variable = {
				var = vote_to_puppet_former_territories
				value = has_support_to_annex_former_territories
				compare = greater_than
			}
		}
		every_country = {
			limit = {
				OR = {
					tag = UKR
					tag = LIT
					tag = GEO
					tag = ARM
					tag = AZR
					tag = TRK
					tag = LAT
					tag = EST
					tag = MOU
					tag = CRI
				}
				NOT = {
					has_government = communism
					is_subject_of = ROOT
					has_country_leader_ideology = vanguardism
					has_country_leader_ideology = marxism
				}
			}
			country_event = {
				id = ww1_russia.124
				days = 2
				random_days = 7
			}
		}
		every_owned_state = {
			limit = {
				is_core_of = TRK 
			}
			transfer_state_to = TRK 
		}
		set_autonomy = {
			target = TRK 
			autonomy_state = autonomy_dominion
		}
		every_owned_state = {
			limit = {
				is_core_of = KAZ
			}
			transfer_state_to = KAZ
		}
		set_autonomy = {
			target = KAZ
			autonomy_state = autonomy_dominion
		}
	}
	if = {
		limit = {
			check_variable = {
				var = votes_for_republic
				value = 0
				compare = greater_than_or_equals
			}
			check_variable = {
				var = votes_for_republic
				value = votes_for_dictatorship
				compare = greater_than_or_equals
			}
			check_variable = {
				var = votes_for_republic
				value = votes_for_tsardom
				compare = greater_than_or_equals
			}
		}
		every_possible_country = {
			limit = {
				has_character = RUS_pavel_milyukov
			}
			RUS_pavel_milyukov = {
				set_nationality = PREV.PREV
			}
		}
		if = {
			limit = {
				NOT = {
					tag = SIB
				}
			}
			set_cosmetic_tag = RUS_republic_democratic
		}
		add_popularity = {
			ideology = democratic
			popularity = 0.40
		}
		set_politics = {
			ruling_party = democratic
			elections_allowed = yes
		}
		RUS_pavel_milyukov = {
			promote_character = yes
		}

	}
	if = {
		limit = {
			check_variable = {
				var = votes_for_tsardom
				value = votes_for_republic
				compare = greater_than
			}
			check_variable = {
				var = votes_for_tsardom
				value = votes_for_dictatorship
				compare = greater_than
			}
			check_variable = {
				var = votes_for_tsardom
				value = 0
				compare = greater_than
			}
		}
		set_cosmetic_tag = RUS
	}
	if = {
		limit = {
			check_variable = {
				var = votes_for_dictatorship
				value = votes_for_republic
				compare = greater_than
			}
			check_variable = {
				var = votes_for_dictatorship
				value = votes_for_tsardom
				compare = greater_than
			}
			check_variable = {
				var = votes_for_dictatorship
				value = 0
				compare = greater_than
			}
		}
		set_cosmetic_tag = RUS_state
	}
}
create_SOV = {
	create_dynamic_country = {
		original_tag = RUS
		set_country_flag = RUS_exile_tag
		set_cosmetic_tag = RUS_exile_tag
		reserve_dynamic_country = yes
		set_politics = {
			ruling_party = neutrality
			elections_allowed = no
		}
		every_state = {
			limit = {
				is_claimed_by = PREV
			}
			remove_claim_by = PREV
		}
		every_state = {
			limit = {
				is_core_of = PREV
			}
			remove_core_of = PREV
		}
	}
	RUS = {
		every_unit_leader = {
			limit = {
				has_trait = trait_royal
			}		
			remove_unit_leader_role = yes
		}
		RUS_pyotr_wrangel = {
			set_portraits = {
				army = {
					large="gfx/leaders/RUS/RUS_pyotr_wrangel_civil_war.png"
				}
			}
		}
		RUS_grigory_semyonov = {
			set_portraits = {
				army = {
					large="gfx/leaders/RUS/RUS_grigory_semenov_civil_war.png"
				}
			}
		}
		every_character = {
			limit = {
				NOT = {
					is_character = RUS_viktor_chernov
					is_character = RUS_boris_savinkov
					is_character = RUS_alexei_brusilov
					is_character = RUS_evgeniy_radkevich
					is_character = RUS_mikhail_bonchbruevich
				}
			}
			set_nationality = RXL
		}
	}
	SOV = {
		clr_country_flag = RUS_soviet_tag
		drop_cosmetic_tag = yes
		every_character = {
			set_nationality = RUS
		}
		reserve_dynamic_country = no	
	}	
	RUS = {
		set_country_flag = RUS_soviet_tag
		set_cosmetic_tag = SOV
		load_focus_tree = soviet_focus
		set_politics = {
			ruling_party = communism
			long_name = SOV_communism_party_long
			name = SOV_communism_party
			elections_allowed = no
		}
		set_party_name = {
			ideology = neutrality
			long_name =SOV_neutrality_party_long
			name = SOV_neutrality_party
		}
		set_party_name = {
			ideology = democratic
			long_name = SOV_democratic_party_long
			name = SOV_democratic_party
		}
		set_party_name = {
			ideology = fascism
			long_name = SOV_fascism_party_long
			name = SOV_fascism_party
		}
		RUS_viktor_chernov = {
			remove_any_country_role_from_character = yes
			remove_country_leader_role = {
				ideology = agrarian_socialism
			}
			add_country_leader_role ={
				promote_leader = yes
				country_leader = {				
					ideology=socialism
				}
			}
		}
		RUS_boris_savinkov = {
			remove_any_country_role_from_character = yes
			remove_country_leader_role = {
				ideology = agrarian_socialism
			}
			add_country_leader_role ={
				promote_leader = yes
				country_leader = {				
					ideology=gen_nazism
					traits={ rider_named_death }
				}
			}
		}
		SOV_vladimir_lenin = {
			promote_character = {
				ideology = vanguardism
			}
		}
		leave_faction = yes
		set_political_power = 0
		set_stability = 0.3
		activate_mission = RUS_kerensky_krasnov_uprising
		add_ideas = {
			partial_economic_mobilisation
			limited_exports
			limited_conscription
			SOV_idea_great_revolution
			SOV_idea_orthodox_church
			SOV_idea_unrecognized_government
			SOV_idea_very_low_peasant_support
			SOV_idea_revolutionary_commanders
			SOV_idea_red_guard
			RUS_demobilizing_army
		}
		if = {
			limit = {
				has_idea = RUS_idea_agrarian_empire	
			}
			remove_ideas = RUS_idea_agrarian_empire
			add_ideas =	SOV_idea_agrarian_state	
		}
		remove_ideas =  {
			RUS_threat_of_revolution
			RUS_threat_of_revolution2
			RUS_threat_of_revolution3
			RUS_idea_orthodox_church
			RUS_idea_strike_movement
			RUS_idea_dual_power
			RUS_idea_volunteer_army
			RUS_idea_tsushima_humiliation
			
		}
		if = {
			limit = {
				GER = {
					has_completed_focus = GER_strike_from_the_shadows
				}
				has_global_flag = strike_from_the_shadows
			}
			RUS = {
				add_timed_idea = {
					idea = GER_idea_abwehr_support
					days = 365
				}
				add_country_leader_trait = german_agent
				set_global_flag = lenin_german_agent
			}
			GER = {
				add_timed_idea = {
					idea = GER_idea_abwehr_supports_revolution
					days = 365
				}
			}
		}
		every_other_country = {
			limit = {
				is_major = yes
				is_subject = no
				any_other_country = {
					is_major = yes
					is_subject = no
					has_war_with = RUS
					has_war_with = PREV
				}
				NOT = {
					has_government = communism
					has_war_with = RUS
				}
			}
			send_embargo = RUS
		}
		RUS_mikhail_bonchbruevich = {
			remove_unit_leader_trait = hidden_sympathies
		}	
		set_country_flag = petrograd_uprising
	}	
}
create_DON = {
	if = {
		limit = {
			DON = {
				exists = no
			}
			any_owned_state = {
				OR = {
					state = 218
					state = 245
					state = 238
					state = 265
				}
			}
		}
		every_owned_state = {
			limit = {
				OR = {
					state = 218
					state = 245
					state = 238
					state = 265
				}
			}
			add_core_of = DON
			remove_core_of = SOV
			every_country = {
				limit = {
					has_war_with = ROOT
					controls_state = PREV
				}
				DON = { give_military_access = PREV }
			}
			transfer_state_to = DON
		}
		DON = {
			load_oob = "DON_1918"
			add_ideas = standing_alone
			load_focus_tree = white_guard_focus
			country_lock_all_division_template = yes
			inherit_technology = RUS
			add_equipment_to_stockpile = {
				type = infantry_equipment
				amount = 2500
				producer = RUS
			}
		}
		every_possible_country = {
			limit = {
				has_character = RUS_pyotr_krasnov
			}
			RUS_pyotr_krasnov = {
				set_nationality = DON	
				add_country_leader_role ={
					promote_leader = yes
					country_leader = {
						ideology=stratocracy
					}
				}
				add_country_leader_role ={
					promote_leader = yes
					country_leader = {
						ideology=despotism
					}
				}
			}
		}
		every_possible_country = {
			limit = {
				has_character = RUS_alexei_kaledin
			}
			RUS_alexei_kaledin = {
				set_nationality = DON
				promote_leader = yes
				add_country_leader_role ={
					promote_leader = yes
					country_leader = {
						ideology=stratocracy
					}
				}
				add_country_leader_role ={
					promote_leader = yes
					country_leader = {
						ideology=oligarchism
					}
				}
			}
		}
	}	
}
create_UKR = {
	if = {
		limit = {
			UKR = {
				exists = no
			}
			any_owned_state = {
				is_core_of = UKR
			}
		}
		every_owned_state = {
			limit = {
				is_core_of = UKR
				NOT = {
					state = 766
				}
			}
			every_country = {
				limit = {
					has_war_with = ROOT
					controls_state = PREV
				}
				UKR = { give_military_access = PREV }
			}
			transfer_state_to = UKR
		}
		set_global_flag = ukraine_released
		every_state = {
			limit = {
				OR = {
					state = 808
					state = 766
				}
			}
			add_claim_by = UKR
		}
		# disagreed with universal
		every_state = {
			limit = {
				OR = {
					region = 192
					state = 221
				}
				is_core_of = UKR
			}
			set_demilitarized_zone = yes
		}
		RUS = {
			transfer_ship = {
				prefer_name = "Svetlana"
				type = light_cruiser
				target = UKR
			}
			transfer_ship = {
				prefer_name = "Ukraina"
				type = destroyer
				target = UKR
			}
			transfer_ship = {
				prefer_name = "Haidamak"
				type = destroyer
				target = UKR
			}
			transfer_ship = {
				prefer_name = "Georgii Pobedonosets"
				type = battleship
				target = UKR
			}
			transfer_ship = {
				prefer_name = "Merkuria"
				type = light_cruiser
				target = UKR
			}
			transfer_ship = {
				prefer_name = "Zorkiy"
				type = destroyer
				target = UKR
			}
			transfer_ship = {
				prefer_name = "Zvonkiy"
				type = destroyer
				target = UKR
			}
			transfer_ship = {
				prefer_name = "Imperator Aleksandr III"
				type = battleship
				target = UKR
			}
			transfer_ship = {
				prefer_name = "Imperatritsa Ekaterina Velikaya"
				type = battleship
				target = UKR
			}
		}
		every_state = {
			limit = {
				is_core_of = UKR
			}
			remove_russian_cores = yes
			remove_russian_claims = yes
		}
		UKR = {
			load_oob = "UKR_army"
			inherit_technology = RUS
			send_embargo = RUS
		}
	}	
}
create_KUB = {
	if = {
		limit = {
			KUB = {
				exists = no
			}
			any_owned_state = {
				OR = {
					state = 234
					state = 579
					state = 941
				}
			}
		}
		every_state = {
			limit = {
				OR = {
					state = 234
					state = 579
					state = 941
					state = 940
					state = 233
				}			
			}	
			add_core_of = KUB	
		}
		every_owned_state = {
			limit = {
				OR = {
					state = 234
					state = 579
					state = 941
				}
			}
			remove_core_of = SOV
			every_country = {
				limit = {
					has_war_with = ROOT
					controls_state = PREV
				}
				KUB = { give_military_access = PREV }
			}
			transfer_state_to = KUB
		}
		KUB = {
			load_oob = "KUB_1918"
			add_ideas = RUS_russian_civil_war
			load_focus_tree = white_guard_focus
			country_lock_all_division_template = yes
			inherit_technology = RUS
			add_equipment_to_stockpile = {
				type = infantry_equipment_0
				amount = 2500
				producer = RUS
			}
		}
	}	
}
create_CRI = {
	if = {
		limit = {
			CRI = {
				exists = no
			}
			OR = {
				owns_state = 137
				owns_state = 955
			}
		}
	}	
}
create_ORE = {
	if = {
		limit = {
			ORE = {
				exists = no
			}
			owns_state = 652
		}
		652 = {
			add_core_of = ORE
			transfer_state_to = ORE
		}
		572 = {
			add_core_of = ORE
		}
		SOV = {		
			send_equipment_fraction = {
				value = 0.15
				target = ORE
			}
		}
		every_possible_country = {
			limit = {
				has_character = RUS_aleksandr_dutov
			}
			RUS_aleksandr_dutov = {
				set_nationality = ORE
				add_country_leader_role ={
					promote_leader = yes
					country_leader = {
						ideology=stratocracy
					}
				}
				add_country_leader_role ={
					promote_leader = yes
					country_leader = {
						ideology=oligarchism
					}
				}
			}			
		}
		ORE = {
			load_oob = "RUS_civil_war"
			add_ideas = RUS_russian_civil_war
			load_focus_tree = white_guard_focus
			delete_obsolete_russian_templates = yes
			inherit_technology = RUS
		}
		652 = {
			create_unit = {
				division = "division_template = \"White Guard Cavalry\"	start_experience_factor = 0.6	start_equipment_factor = 1"
				owner = ORE
				allow_spawning_on_enemy_provs = yes
				count = 4
			}
		}
	}

}
create_UCH = {
	if = {
		limit = {
			UCH = {
				exists = no
			}
			owns_state = 943
		}
		943 = {
			add_core_of = UCH
			transfer_state_to = UCH
		}
		UCH = {
			load_oob = "RUS_civil_war"
			add_ideas = RUS_russian_civil_war
			load_focus_tree = white_guard_focus
			delete_obsolete_russian_templates = yes
			inherit_technology = RUS
		}
		943 = {
			create_unit = {
				division = "division_template = \"White Guard Cavalry\"	start_experience_factor = 0.6	start_equipment_factor = 1"
				owner = UCH
				allow_spawning_on_enemy_provs = yes
				count = 5
				country_score = {
					base = 100
				}
			}
		}
		SOV = {
			send_equipment_fraction = {
				value = 0.15
				target = UCH
			}
		}
	}
}
create_TER = {
	if = {
		limit = {
			TER = {
				exists = no
			}
			owns_state = 232
		}
		232 = {
			every_country = {
				limit = {
					has_war_with = ROOT
					controls_state = PREV
				}
				TER = { give_military_access = PREV }
			}
			add_core_of = TER
			transfer_state_to = TER
		}
		TER = {
			add_ideas = RUS_russian_civil_war
			load_focus_tree = white_guard_focus
			inherit_technology = RUS
			give_military_access = ROOT
		}
	}
}
create_MOU = {
	if = {
		limit = {
			MOU = {
				exists = no
			}
			owns_state = 565
		}
		# Mountainous Republic
		565 = {
			every_country = {
				limit = {
					has_war_with = ROOT
					controls_state = PREV
				}
				MOU = { give_military_access = PREV }
			}
			transfer_state_to = MOU
		}
		MOU = {
			add_ideas = standing_alone
			set_politics = {
				ruling_party = democratic
			}
			add_popularity = {
				ideology = democratic
				popularity = 0.30
			}
			give_military_access = ROOT
		}
	}
}
create_october_revolution_breakaways = {
	RUS = {
		
		
		# country_event = {
		# 	id = ww1_russia.95
		# 	hours = 1 #days = 10 
		# }
		#Ukrainian People's Republic
		# country_event = {
		# 	id  = ww1_russia.34
		# 	hours = 2 #days = 13
		# }
		
		#stavropol sr
		country_event = {
			id = ww1_kub.4
			days = 30
		}
		
		#Kuban
		# country_event = {
		# 	id = ww1_russia.94
		# 	hours = 3 #days = 1
		# }
		# #Kuban
		# country_event = {
		# 	id = ww1_russia.94
		# 	hours = 1 #days = 1
		# }
		#Orenburg Cossacks
		# country_event = {
		# 	id  = ww1_rcw.1
		# 	hours = 1
		# }
		# #Ural Cossacks
		# country_event = {
		# 	id = ww1_rcw.7
		# 	hours = 1
		# }
		#Black Sea SR
		country_event = {
			id = ww1_kub.2
			days = 98
		}
		#Terek Sr
		country_event = {
			id = ww1_kub.3
			days = 98
		}	
		#Amur SR
		country_event = {
			id = ww1_rcw.5
			days = 128
		}
		#Kuban Black Sea SR
		KUB = {
			country_event = {
				id = ww1_kub.6
				days = 226
			}
		}
	}
}