SAU_arabian_conquest = { 
	SAU_conquer_al_hasa = {
		icon = border_war
		allowed = {
			original_tag = SAU
		}
		visible = {
			NOT = {
				owns_state = 804
			}
			292 = {
				is_owned_and_controlled_by = ROOT
			}
		}
		target_trigger = {
			FROM = {
				owns_state = 804
			}
		}
		available = {
			has_war = no
			804 = {
				is_owned_and_controlled_by = FROM
			}
			# saud did this even they had garrison there
			FROM = {
				OR = {
					num_divisions_in_states = {
						count < 1
						states = { 804 }
						exclude = { irregular_infantry irregular_cavalry }
					}
					#ww1
					has_war_with = GER
					has_war_with = FRA
					#balkan
					has_global_flag = kis_firstbalkanwar_victory
				}
				NOT = {
					owns_state = 656
					owns_state = 904
					owns_state = 905
					has_subject = ROOT
				}
			}
			NOT = {
				has_idea = idea_army_restrictions
				has_active_mission = frankfurt_conference
				has_active_mission = versallies_conference
			}
		}
		highlight_states = {
			highlight_state_targets = {
				state = 804
			}
		}
		ai_will_do = {
			base = 100
			modifier = {
				add = 1000
				FROM = { has_war = yes }
			}
			modifier = {
				add = 1000
				FROM = {
					num_divisions_in_states = {
						count < 1
						states = { 804 }
						exclude = { irregular_infantry irregular_cavalry }
					}
				}
			}
			modifier = {
				factor = 0
				date < 1913.5.1
				NOT = { has_global_flag = kis_firstbalkanwar_victory }
			}
		}
		fire_only_once = yes
		complete_effect = {
			effect_tooltip = {
				transfer_state = 804
				FROM = {
					if = {
						limit = { has_subject = QAT }
						end_puppet = QAT
					}
				}
				if = {
					limit = {
						NOT = {
							has_cosmetic_tag = SAU_nejd_and_hejaz
							has_cosmetic_tag = SAU_saudi_arabia
							has_cosmetic_tag = SAU_sultanate
						}
					}
					set_cosmetic_tag = SAU_nejd_and_hasa
				}
			}
			hidden_effect = {
				FROM = {
					country_event = ottoman.96
				}
			}
		}
	}
	SAU_invade_kuwait = {
		icon = border_war
		allowed = {
			original_tag = SAU
		}
		visible = {
			is_subject = no
			NOT = {
				owns_state = 905
			}
			292 = {
				is_owned_and_controlled_by = ROOT
			}
			TUR = {
				has_country_flag = great_war_loser
			}
		}
		target_trigger = {
			FROM = {
				owns_state = 905
			}
		}
		available = {
			has_war = no
			owns_state = 804
			NOT = {
				has_idea = idea_army_restrictions
				has_active_mission = frankfurt_conference
				has_active_mission = versallies_conference
			}
		}
		highlight_states = {
			highlight_state_targets = {
				state = 905
			}
		}
		war_with_target_on_complete = yes
		ai_will_do = {
			factor = 100
			modifier = {
				factor = 0
				date < 1919.1.1
			}
		}
		fire_only_once = yes
		complete_effect = {
			if = {
				limit = {
					has_subject = FROM
				}
				every_state = {
					limit = {
						is_owned_by = FROM
						OR = {
							state = 904
							state = 905
						}
					}
					transfer_state_to = ROOT
				}
				else = {
					add_state_claim = 904
					add_state_claim = 905
					if = {
						limit = {
							NOT = { has_war_with = FROM }
						}
						FROM = { country_event = ww1_nejd.1 }
					}
				}
			}
		}
	}
	SAU_battle_of_jarrab = {
		icon = border_war
		allowed = {
			original_tag = JBS
		}
		visible = {
			TUR = {
				has_war_with = ENG
			}
		}
		target_trigger = {
			FROM = {
				owns_state = 918
			}
		}
		available = {
			is_subject = no
			has_war = no
			NOT = {
				has_idea = idea_army_restrictions
				has_active_mission = frankfurt_conference
				has_active_mission = versallies_conference
			}
		}
		highlight_states = {
			highlight_state_targets = {
				state = 918
			}
		}
		ai_will_do = {
			factor = 1000
		}
		war_with_target_on_complete = yes
		fire_only_once = yes
		complete_effect = {
			start_border_war = {
				change_state_after_war = no
				attacker = {
					state = 791
					num_provinces = 3
					on_win = ww1_nejd.17
					on_lose =  ww1_nejd.18
					dig_in_factor = 0
					terrain_factor = 0
				}	
				defender = {
					state = 918
					num_provinces = 3
					on_win =  ww1_nejd.16
					on_lose =  ww1_nejd.15
					dig_in_factor = 0
					terrain_factor = 0
				}
			}
			SAU = {
				country_event = ww1_nejd.14
			}
		}
	}
	SAU_unite_JBS = {
		icon = border_war
		allowed = {
			original_tag = SAU
		}
		visible = {
			country_exists = JBS
			NOT = {
				has_subject = JBS
			}
		}
		available = {
			292 = {
				is_owned_and_controlled_by = ROOT
			}
			TUR = {
				has_country_flag = great_war_loser 
			}
			NOT = {
				has_idea = idea_army_restrictions
				has_active_mission = frankfurt_conference
				has_active_mission = versallies_conference
			}
		}
		ai_will_do = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					date < 1921.8.1
					AND = {
						is_in_faction = yes
						is_faction_leader = no
					}
				}
			}
			modifier = {
				factor = 0
				JBS = {
					OR = {
						has_country_flag = great_war_winner
						is_subject = yes
						is_in_faction = yes
					}				
				}
			}
		}
		war_with_target_on_remove = yes
		target_trigger = {
			FROM = {
				tag = JBS
			}
		}
		fire_only_once = yes
		days_remove = 45
		complete_effect = {
			if = {
				limit = {
					is_subject_of = ENG
				}
				ENG = { end_puppet = ROOT }
			}
			every_state = {
				limit = {
					is_owned_by = FROM
					is_core_of = FROM
				}
				add_claim_by = ROOT
			}
			FROM = {
				every_state = {
					limit = {
						is_owned_by = ROOT
						is_core_of = ROOT
					}
					add_claim_by = PREV
				}
			}
		}
		remove_effect = {
			declare_war_on = {
				target = FROM
				type = annex_everything
			}
		}
	}
	SAU_declare_sultanate = {
		icon = infiltrate_state
		allowed = {
			original_tag = SAU
		}
		available = {
			JBS = {
				OR = {
					exists = no
					is_subject_of = PREV
				}				
			}
		}
		visible = {
			OR = {
				has_full_control_of_state = 791
				has_subject = JBS
			}
		}
		ai_will_do = {
			factor = 100
		}
		fire_only_once = yes
		complete_effect = {
			hidden_effect = {
				every_other_country = {
					limit = {
						owns_state = 554
						NOT = {
							is_subject_of = PREV
							has_war_with = PREV
						}
					}
					transfer_state = 831
					831 = { remove_core_of = JBS add_core_of = SYR }
				}
				every_other_country = {
					limit = {
						owns_state = 455
						NOT = {
							is_subject_of = PREV
							has_war_with = PREV
						}
					}
					transfer_state = 832
					832 = { remove_core_of = JBS add_core_of = SYR }
				}
				every_other_country = {
					limit = {
						owns_state = 291
						NOT = {
							is_subject_of = PREV
							has_war_with = PREV
						}
					}
					transfer_state = 675
					675 = { remove_core_of = JBS add_core_of = IRQ }
					transfer_state = 916
					916 = { remove_core_of = JBS add_core_of = IRQ }
					transfer_state = 917
					917 = { remove_core_of = JBS add_core_of = IRQ }
				}
			}
			every_state = {
				limit = {
					is_claimed_by = JBS
				}
				remove_claim_by = JBS
			}
			every_state = {
				limit = {
					is_core_of = JBS
				}
				remove_core_of = JBS
				add_core_of = PREV
			}
			if = {
				limit = {
					has_subject = JBS
				}
				annex_country = {
					target = JBS
					transfer_troops = yes
				}
			}
			set_cosmetic_tag = SAU_sultanate
		}
	}
	SAU_unite_HJZ = {
		icon = border_war
		allowed = {
			original_tag = SAU
		}
		visible = {
			country_exists = FROM
			NOT = {
				has_subject = FROM
			}
		}
		available = {
			NOT = {
				has_idea = idea_army_restrictions
				has_active_mission = frankfurt_conference
				has_active_mission = versallies_conference
			}
			ASR = { 
				OR = {
					exists = no
					is_puppet_of = PREV 
				}
			}
			strength_ratio = {
				tag = FROM
				ratio > 0.8
			}		
		}
		ai_will_do = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					date < 1925.12.1
					AND = {
						is_in_faction = yes
						is_faction_leader = no
					}
				}
			}
			modifier = {
				factor = 0
				FROM = {
					OR = {
						is_subject = yes
						is_in_faction = yes
					}
				}
			}
			modifier = {
				factor = 0
				NOT = { has_global_flag = interbellum }
			}
		}
		war_with_target_on_remove = yes
		target_trigger = {
			FROM = {
				tag = HJZ
			}
		}
		fire_only_once = yes
		days_remove = 45
		complete_effect = {
			every_state = {
				limit = {
					is_owned_by = FROM
					is_core_of = FROM
				}
				add_claim_by = ROOT
			}
		}
		remove_effect = {
			create_wargoal = {
				target = FROM
				type = annex_everything
			}
		}
	}
	SAU_declare_kingdom_of_hejaz_and_nejd = {
		icon = infiltrate_state
		allowed = {
			original_tag = SAU
		}
		available = {
			HJZ = {
				OR = {
					exists = no
					is_subject_of = PREV
				}		
			}
			has_cosmetic_tag = SAU_sultanate
		}
		visible = {
			OR = {
				AND = {
					has_full_control_of_state = 679
					has_full_control_of_state = 878
				}
				has_subject = HJZ
			}
		}
		ai_will_do = {
			factor = 100
		}
		fire_only_once = yes
		complete_effect = {
			every_state = {
				limit = {
					is_core_of = HJZ
				}
				add_core_of = SAU
				remove_core_of = HJZ
			}
			set_cosmetic_tag = SAU_nejd_and_hejaz
			if = {
				limit = {
					has_subject = HJZ
				}
				annex_country = {
					target = HJZ
					transfer_troops = yes
				}
			}
		}
	}
	SAU_unite_ASR = {
		icon = border_war
		allowed = {
			original_tag = SAU
		}
		visible = {
			country_exists = FROM
			NOT = {
				has_subject = FROM
			}
		}
		available = {
			NOT = {
				has_idea = idea_army_restrictions
				has_active_mission = frankfurt_conference
				has_active_mission = versallies_conference
			}
			JBS = { exists = no }
			292 = {
				is_owned_and_controlled_by = ROOT
				is_core_of = ROOT
			}
			791 = {
				is_owned_and_controlled_by = ROOT
				is_core_of = ROOT
			}
			strength_ratio = {
				tag = FROM
				ratio > 0.8
			}		
		}
		ai_will_do = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					date < 1925.12.1
					AND = {
						is_in_faction = yes
						is_faction_leader = no
					}				
				}
			}
			modifier = {
				factor = 0
				ASR = {
					OR = {
						is_subject = yes
						is_in_faction = yes
					}				
				}
			}
			modifier = {
				factor = 0
				NOT = { has_global_flag = interbellum }
			}
		}
		war_with_target_on_remove = yes
		target_trigger = {
			FROM = {
				tag = ASR
			}
		}
		fire_only_once = yes
		days_remove = 45
		complete_effect = {
			every_state = {
				limit = {
					is_owned_by = FROM
					is_core_of = FROM
				}
				add_claim_by = ROOT
			}
		}
		remove_effect = {
			declare_war_on = {
				target = FROM
				type = annex_everything
			}
		}
	}
	SAU_declare_saudi_arabia = {
		icon = infiltrate_state
		allowed = {
			original_tag = SAU
		}
		available = {
			has_capitulated = no
			ASR = {
				OR = {
					exists = no
					is_subject_of = PREV
				}
			}
			HJZ = {
				OR = {
					exists = no
				}
			}
			292 = {
				is_fully_controlled_by = SAU
			}
			678 = {
				is_fully_controlled_by = SAU
			}
			662 = {
				is_fully_controlled_by = SAU
			}
			679 = {
				is_fully_controlled_by = SAU
			}
			747 = {
				is_fully_controlled_by = SAU
			}
			791 = {
				is_fully_controlled_by = SAU
			}
			878 = {
				is_fully_controlled_by = SAU
			}
		}
		visible = {
			NOT = { has_cosmetic_tag = SAU_saudi_arabia }
		}
		ai_will_do = {
			factor = 100
		}
		fire_only_once = yes
		complete_effect = {
			every_owned_state = {
				limit = {
					OR = {
						is_core_of = ASR
						is_core_of = OMA
						is_core_of = YEM
						is_core_of = QAT
						is_core_of = KUW
						is_core_of = UAE
						is_core_of = IRQ
						is_core_of = PAL
						is_core_of = SYR
						is_core_of = JOR
						state = 904
						state = 905
					}				
				}
				add_core_of = SAU
				if = {
					limit = {
						is_core_of = ASR
					}
					remove_core_of = ASR
				}
			}
			if = {
				limit = {
					has_subject = ASR
				}
				annex_country = {
					target = ASR
					transfer_troops = yes
				}
			}
			set_cosmetic_tag = SAU_saudi_arabia
			news_event = {
				id = interwar_news.19
				hours = 3
			}
			remove_ideas = unification_of_arabia
		}
	}
	SAU_unite_NAJ = {
		icon = border_war
		allowed = {
			original_tag = SAU
		}
		target_trigger = {
			FROM = {
				owns_state = 929
			}
		}
		war_with_target_on_complete = yes
		visible = {
			owns_state = 292
			NOT = {
				has_war_with = FROM
			}
		}
		available = {
			is_subject = no
			has_war = no
			FROM = {
				is_subject = no
			}
			NOT = {
				has_idea = idea_army_restrictions
				has_active_mission = frankfurt_conference
				has_active_mission = versallies_conference
			}
		}
		ai_will_do = {
			factor = 100
			modifier = {
				factor = 0
				date < 1934.1.1
			}
			modifier = {
				factor = 0
				strength_ratio = {
					tag = FROM
					ratio > 1.0
				}
			}
		}
		fire_only_once = yes
		complete_effect = {
			add_state_core = 929
			start_border_war = {
				change_state_after_war = no
				attacker = {
					state = 292
					num_provinces = 3
					on_win = ww1_yemen.6
					on_lose =  ww1_yemen.7
				}
				defender = {
					state = 929
					num_provinces = 1
					on_win =  ww1_yemen.8
					on_lose =  ww1_yemen.9
				}
			}
		}
	}
}
crisis = {
	SAU_ottoman_saudi_treaty_timer = {
		icon = GFX_decision_generic_protection
		allowed = {
			OR = {
				original_tag = SAU
				original_tag = TUR
			}
		}
		days_mission_timeout = 365
		activation = {
			SAU = {
				owns_state = 804
				NOT = {
					has_war_with = TUR
				}
			}
			NOT = {
				has_global_flag = kis_war
				TUR = {
					has_idea = idea_army_restrictions
					has_country_flag = great_war_loser
				}
				has_global_flag = ottoman_saudi_in_progress
				has_global_flag = ottoman_saudi_treaty
			}
		}
		available = {
			OR = {
				has_global_flag = kis_war
				SAU = {
					has_war_with = TUR
				}
				NOT = { country_exists = SAU }
				NOT = { country_exists = TUR }
				TUR = { has_subject = SAU }
				TUR = { is_subject = yes }

				has_global_flag = ottoman_gave_up_alhasa
				SAU = {
					is_subject_of = ENG
				}
				TUR = {
					has_wargoal_against = SAU
				}
			}
		}
		fire_only_once = yes
		is_good = no
		timeout_effect = {
			if = {
				limit = {
					has_global_flag = ottoman_saudi_in_progress
				}
				effect_tooltip = {
					TUR = { puppet = SAU }
				}
				hidden_effect = {
					if = {
						limit = { tag = SAU }
						get_current_government_type = yes
						TUR = {
							set_autonomy = {
								target = ROOT
								autonomy_state = autonomy_tgwr_ottoman_emirate
							}
						}
						restore_previous_government_type = yes
						add_ideas = TUR_wavering_ottoman_influence
					}
				}
			}
			else = {
				effect_tooltip = {
					TUR = {
						create_wargoal = {
							target = SAU
							type = puppet_wargoal_focus
						}
					}
				}
				hidden_effect = {
					if = {
						limit = { tag = TUR }
						create_wargoal = {
							target = SAU
							type = puppet_wargoal_focus
						}
					}
				}
			}
		}
	}
}